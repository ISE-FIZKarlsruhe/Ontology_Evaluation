The market for the small-scale micro gas turbine is expected to grow rapidly in the coming years. Especially, utilization of commercial off-the-shelf components is rapidly reducing the cost of ownership and maintenance, which is paving the way for vast adoption of such units. However, to meet the high-reliability requirements of power generators, there is an acute need of a real-time monitoring system that will be able to detect faults and performance degradation, and thus allow preventive maintenance of these units to decrease downtime. In this paper, a micro gas turbine based combined heat and power system is modelled and used for development of physics-based diagnostic approaches. Different diagnostic schemes for performance monitoring of micro gas turbines are investigated.
According to multiple sources, the global market for micro gas turbine (MGT) will experience an expeditious growth in the coming years [
1
,
2
,
3
]. The power generation segment of its product portfolio is expected to contribute to a bulk portion of this growth. In particular, the combined heat and power (CHP) configuration of this energy generator are grabbing much attention from both the industry and the policy makers [
4
,
5
]. Especially in the context of European Unions’(EU) initiatives against climate change, these micro-CHP units could play a vital role in achieving both short- and long-term emission reduction targets.
MGTs are gas turbines combined with high speed generators whose electrical output can range between few kilowatts and few hundreds kilowatts. They offer a number of benefits compared to other technologies for distributed heat and power generation, including compact size, lightweight, fewer moving parts, lower maintenance needs, lower noise and vibration, high reliability, higher fuel flexibility, lower emission levels, potential for low cost mass production, and potential for integration with others decentralised energy generators [
6
,
7
,
8
,
9
]. On the other hand, the main drawbacks of MGTs are low electrical efficiency, high research and development cost, and high ownership cost at the moment [
5
,
7
]. However, numerous development activities are under-way by academia, industry, and policy makers to overcome the aforementioned challenges.
To bring the cost of ownership down, multiple vendors are offering micro-CHP units that are being developed by utilizing commercial off-the-shelf (COTS) components from automotive turbocharger industry. The inclusion of mature turbocharger technology offers not only cost reduction, but also high reliability and robustness that the industry achieved through decades of continuous improvement. On the contrary, turbochargers are not optimised for MGT operation due to the trade-off between design point efficiency and cost of manufacturing. For this reason, the MGT market is still considered to be a niche market, and the cost for development of turbo-machinery optimised for MGT operation can only be justified with mass production. Hence, modification of automotive turbocharger is often preferred to improve design point efficiency.
In the context of a power sector with high share of intermittent energy sources, MGTs should offer high reliability and availability to ensure the security of supply. Subsequently, an on-line condition-based monitoring and fault detection system is necessary. MGT runtime can be extended by early detection of faults and performance degradation. Thus, it will be possible to plan maintenance activity long before a breakdown occurs. Eventually, this will improve the availability and lower the maintenance cost. Another important aspect of future MGT market that emphasises the need of a condition-based monitoring and fault detection system is the ownership structure. Traditionally, gas turbines are owned by utilities and large companies. However, MGT-based CHP units could also be owned by private persons and small and medium enterprises (SME). Hence, a service-oriented approach is vital, where the service provider (i.e., technology provider or system installer or independent service provider) might need to manage a large fleet of MGT units. This is where the concept of fleet level monitoring and diagnostics can play an important role. The service provider will be responsible for monitoring the MGT fleet and planning maintenance based on the engine health conditions and severity of deterioration. Hence, an integrated approach for MGT fleet monitoring and diagnostics is necessary to foster the adoption of this promising technology. Since the MGT technology is still in the early stage of commercialization phase, sufficient data on degraded and faulty operations are lacking, which rules out the use of data-driven diagnostics approaches for the moment. Moreover, data-driven approaches perform worse for cases that fall outside of the training dataset, which could be a limitation considering the wide operating flexibility that is expected from MGT units. Therefore, physics-based modelling for MGT diagnostics appears necessary to overcome the aforementioned challenges.
Realizing its potential, the exploitation of a physics-based model for MGT fleet monitoring and diagnostics is investigated in this paper. A diagnostic-oriented model for an MGT based CHP unit is developed. An in-house Fortran-based gas turbine modelling tool named EnVironmental Assessment (EVA) is used for model development [
10
,
11
]. Model adaptation techniques for individual MGT units in a fleet are also discussed in detail. Subsequently, a multi-level fault detection and isolation methods are presented along with a detailed fault diagnostics scheme that can identify the location and magnitude of different component faults. Finally, several simulation trials are performed to test the presented fault diagnostics scheme.
The performance of gas turbines deteriorates over time, leading to reduced output capacity and thermal efficiency that in turn result in reduced profitability and increased emissions [
12
]. Generally, any performance deterioration in a gas turbine can be linked with performance deterioration of one or more gas path components. The performance of these components deteriorate over time due to various degradation mechanisms such as fouling, erosion, corrosion, internal liner surface cracking, increase in tip and seal clearance, foreign object damage, plugging of the injector and the cooling holes, etc. [
13
,
14
,
15
]. The rate at which these deterioration mechanisms take place could be different depending on the manufacturing tolerance, engine operating conditions, operating regime, i.e., part or full load, start-stop cycles, and fuel type and quality. Deterioration generally causes deviations in the component performance parameters, i.e., efficiency, pressure ratio, flow capacity, and others, which in turn lead to deviations in the gas path measurable parameters such as temperatures, pressures, speed, and flow rates. Using the gas path measurable parameters to detect the change in component health parameters forms the foundation for performance-based gas path analysis (GPA) methods for gas turbine diagnostics. Two of the well-known variants of this method are physics-based and data-driven GPA. Numerous comprehensive review articles explore existing GPA approaches (both physics-based and data-driven) and their relative performance [
16
,
17
,
18
,
19
,
20
]. In these articles, the comparative pros and cons of different approaches are examined based on attributes such as reliability, accuracy, model complexity, computational efficiency, the ability to cope with noise and bias, and number of measurements required for diagnostics. The findings of these reviews can be summarized by stating that there is no single approach that outperforms the others in all the attributes; rather they are complementary and each has its own benefits and drawbacks. Hence, hybrid schemes that combine both physics-based and data-driven approaches should be preferred. As a starting point for MGT diagnostics and in light of the limitations previously discussed, the focus of this study is limited to a physics-based approach.
Physics-based GPA approaches for gas turbines diagnostics have been widely studied by the research community over the years. As the name suggests, these approaches explicitly rely on the physics-based models of gas turbines. The models are based on mathematical and thermodynamic equations that principally correlate gas path measurable parameters with component performance parameters. The has approach developed much since Urban pioneered it in 1967 [
21
]. Urban [
22
,
23
] and others [
24
,
25
,
26
] further investigated the approach, which is widely referred to as linear GPA in the literature. In linear GPA, unknown variations in components performance parameters are computed from known variations in measurable parameters by using a set of linear equations. The equations are derived by linearising the non-linear equations that link components performance parameters with measurable parameters, around a specific steady-state operating point. Being conceptually simple and computationally light, linear GPA offers numerous benefits such as fault isolation and quantification and multiple faults diagnostics. On the other hand, the method has multiple limitations. It requires many relevant measurements for fault diagnostics, which can be quite rare in commercial units. Due to the assumption of linearity, the method shows instability and large inaccuracy under higher level of deteriorations. Moreover, it is unable to deal with sensor noise and bias.
To cope with the non-linear behaviour of the gas turbines and improve the accuracy of GPA, non-linear GPA was introduced by House [
27
] and Esher [
28
]. The method was further improved by many others. Unlike linear GPA, in non-linear GPA, the full equations are treated directly without any linearisation. To deal with the engine to engine variations, an adaptive approach of non-linear GPA was examined by Stamatis et al. [
29
]. The author introduced modification factors to the health parameters to take care of the individual engine variation that are computed through an optimisation procedure. Li [
30
] developed a two step approach for linear and non-linear adaptive GPA that can detect both single and simultaneously occurring multiple faults. Not long ago, Larsson [
31
] presented a systematic design procedure to construct a fault detection and isolation system by using complex non-linear models. In a more recent work, Liu [
32
] proposed a dynamic tracking filter incorporating state observer to detect the variation of six performance parameters of three gas path components by using four measurement parameters. However, the usage of linear state observer resulted in reduced accuracy in fault detection capability of this approach; hence, a non-linear state observer is required. In another work, Kang [
33
] suggested a compressor map adaptation technique to enhance the accuracy of performance based diagnostics of a heavy-duty gas turbine. Comparison of different diagnostics approaches are studied in Koskoletos et al. [
34
]. The authors performed a comparative analysis among: (1) probabilistic neural network (PNN); (2) k-nearest neighbours; (3) optimization; (4) combinatorial; (5) adaptive 2X2; and (6) combination of PNN and adaptive 2X2 method. They concluded that Methods 3–6 can be used for component fault magnitude estimation and prognostic purpose.
Previous research efforts have made valuable contributions in improving performance-based gas path diagnostics methods. However, most of this work is focused on large scale industrial gas turbines; only a few studies are focused on micro gas turbine [
35
,
36
,
37
,
38
]. Performance-based diagnostics of MGT by employing GPA poses numerous challenges. To keep the cost of ownership down, MGTs include only few measurements of gas path parameters. Moreover, some of these measurements are used for control purpose, meaning that they cannot be utilized for diagnostics. Due to the high manufacturing tolerances, engine components show wide variations in performance, which could lead to deviations in measured parameters that are comparable to fault conditions. Hence, model tuning is essential for individual engines before employing any fault diagnostics approach.
To develop a model-based diagnostics scheme for an MGT fleet, a diagnostics-oriented model of a nominal MGT unit is developed and presented in this article. The developed model is validated against the measurements from the performance test of a commercial MGT unit. Sequentially, a scheme for model tuning is employed to account for engine to engine variations. Finally, a diagnostics scheme is proposed and tested with the help of simulation studies.
The operating principle of an MGT is identical to large-scale open cycle gas turbines. Both operate on the well-known Brayton cycle. As shown in 
Figure 1
, a typical MGT with CHP configuration consists of a compressor, a recuperator, combustor, a turbine, a high-speed generator, and an exhaust recovery heat exchanger. The air is compressed in the compressor and then preheated by the exhausts in the recuperator before being further heated by burning fuel in the combustor. The high temperature working fluid is then expanded in the turbine that operates the compressor and the high-speed generator. The remaining exhaust heat is recovered by water in the recovery heat exchanger.
The MGT unit under study in this paper is the EnerTwin Micro-CHP that is marketed by Micro Turbine Technology (MTT) B.V. It is a single-shaft, radial, recuperated gas turbine manufactured in CHP configuration. The micro-CHP unit have a capacity of 3.2 kW of electric and 16 kW thermal output.
A modular modelling technique is employed here to develop the MGT model. All the gas path components, i.e., compressor, recuperator, combustor and turbine including duct and rotating shaft are modelled and integrated just like the way they are connected in reality. As mentioned previously, the MGT model is developed by using an in-house Fortran-based gas turbine modelling tool called EVA. It is a multidisciplinary conceptual design tool that comprises various modules incorporating substantial detail within a wide range of disciplines, i.e., gas turbine performance, aerodynamic and mechanical design, emissions prediction, and environmental impact. In this work, the gas turbine performance analysis module of the tool is utilized.
The compressor and turbine models are based on their corresponding characteristic maps provided by the manufacturer and standard mass and energy balance equations. The characteristics maps provide correlations between pressure ratio (




P


R




), shaft speed (
N
), mass flow rate (




m


˙




), and isentropic efficiency (




η




i


s






), as shown in Equation (
1
).
















m


˙




·






T




i


n












P




i


n








,




η




i


s








=


f




P


R


,




N






T




i


n




















(1)





where 




T




i


n






 and 




P




i


n






 refer to the inlet temperature and pressure respectively. For a known shaft speed and pressure ratio, corresponding mass flow rate and isentropic efficiency are extracted from the characteristic maps. The extracted values are then used in well-known thermodynamic equations to calculate parameters related to compressor and turbine. For example, compressor outlet temperature (




T


2




), pressure (




P


2




), and compression work (




W




c


o


m


p


.






) are calculated utilizing Equations (
4
), (
7
) and (
9
).
Starting by assuming isentropic compression and expansion in the compressor and turbine, respectively, the Gibbs equation takes the following form:
















S




o


u


t






−




S




i


n








︸






=


0






=




∫






T




i


n










T




o


u


t


,


i


s


.












C


p




T




·


d


T


−




R


g




·


ln








P




o


u


t








P




i


n


















(2)




Here, 
S
 refers to the entropy, 






C


p






 is the specific heat capacity and 






R


g






 is the universal gas constant. Defining entropy function as in Equation (
3
),








ϕ




(


T


)




=




∫






T




r


e


f


.








T










C


p






T




·


d


T










(3)




Equation (
4
) is derived:








ϕ




(




T




o


u


t


,


i


s


.






)




=


ϕ




(




T




i


n






)




+




R


g




·


ln








P




o


u


t








P




i


n


















(4)




Here, 




ϕ


(




T




i


n






)




 and 




ϕ


(




T




o


u


t


,


i


s






)




 are the temperature dependent entropy functions at the inlet and outlet of the component (i.e., compressor or turbine).
However, the isentropic assumptions are not applicable to real compression and expansion processes which have inherent losses due to compressor and turbine inefficiencies. To account for these losses, isentropic efficiencies for compressor (




η




c


o


m


p


.


,


i


s


.






) and turbine (




η




t


u


r


b


.


,


i


s


.






) are defined as in Equations (
5
) and (
6
).










η




c


o


m


p


.


,


i


s


.






=






h




(




T




2


,


i


s


.






)




−


h




(




T


1




)








h




(




T


2




)




−


h




(




T


1




)
















(5)














η




t


u


r


b


.


,


i


s


.






=






h




(




T


5




)




−


h




(




T


4




)








h




(




T




5


,


i


s


.






)




−


h




(




T


4




)
















(6)




Subsequently, compressor and turbine pressure ratios are defined by Equations (
7
) and (
8
).








P




R




c


o


m


p


.






=






P


2






P


1














(7)












P




R




t


u


r


b


.






=






P


4






P


5














(8)




Finally, compressor and turbine works are calculated using Equations (
9
) and (
10
),










W




c


o


m


p


.






=






m


˙




1








h


2




−




h


1














(9)














W




t


u


r


b


.






=






m


˙




4








h


4




−




h


5














(10)




Here, 




ϕ


(




T


1




)




 and 




ϕ


(




T


2




)




 are the temperature dependent entropy functions at the inlet and outlet of the compressor, and 




R


g




 is the universal gas constant.
The recuperator is modelled as a counter-current plate type heat exchanger. Heat exchanger’s key performance parameters related to heat transfer and pressure drop are used for this purpose. The thermal effectiveness (


ϵ


) is used as heat transfer performance parameter, while relative pressure drop in the air-side (




Δ




P


23






) and gas-side (




Δ




P


56






) are introduced as pressure drop performance parameters. A heat flux-based definition of effectiveness is considered instead of a temperature-based one to include the influence of the gas composition on the specific heat capacity, as shown in Equation (
11
).








ϵ


=






Q




a


c


t


.








Q




m


a


x


.
















(11)












Δ




P


23




=








P


3




−




P


2








P


2














(12)














Δ




P


56




=








P


6




−




P


5








P


5














(13)





where 




Q




a


c


t


.






 and 




Q




m


a


x


.






 refer to actual heat transfer and maximum possible heat transfer in the recuperator. The maximum possible heat transfer is achieved when the fluid with minimum heat capacity rate undergoes the maximum temperature difference available present in the exchanger, which is the difference in the entering temperatures for the hot and cold fluids.
The combustor performance is given in terms of combustion efficiency (




η




c


o


m


b


.






) and relative pressure drop (




Δ




P


34






). The combustor efficiency can be computed by Equation (
14
), while relative pressure drop can be computed using an equation similar to Equation (
12
). Using these parameters, fuel to air ratio (FAR) and pressure at exit of the combustor (




P


4




) are determined. Finally, energy balance is applied for the combustor to estimate the enthalpy at the combustor outlet that in-turn is used to determine the temperature. For simplicity, a constant lower heating value (LHV) is used in Equation (
14
).










η




c


o


m


b


.






=










m


˙




3






(




h


3




−




h


2




)












m


˙




f




·


L


H


V














(14)




Compressor, turbine, and generator are mounted on the same shaft; hence, the shaft mechanical efficiency is defined as in Equation (
15
).










η




s


h


a


f


t






=








W




c


o


m


p


.






+




W




g


e


n


.










W




t


u


r


b


.
















(15)




Pressure losses in the ducts are also taken into account by using an equation similar to Equation (
12
).
The steady state operating points of the gas turbine are obtained by matching the compressor and turbine. This is done by superimposing turbine map on the compressor map while mass flow and energy continuity are maintained. The serial nested loops method is used where initial guesses are continuously updated until all the residuals error terms, corresponding to components mass and energy balance, reach predefined accuracy. To do this, a Jacobian matrix is built where each element of the matrix is the sensitivity ratio between each output (or target) and state (




δ


Y




/




δ


X




). The Jacobian is used to compute and minimize the residuals between model outputs and targets. In normal conditions, the Jacobian consists of the following pairs of outputs and states in the rows and columns as shown in 
Table 1
.
For example, the mass continuity in the compressor needs to be satisfied, which means that the mass flow calculated from the compressor map needs to match the compressor inlet mass flow. The speed factor 




N




r


e


l


.






, defined as 




N


/




N




d


e


s


.








, is then varied until the residual between the two mass flow values (






m


˙






c


o


m


p


.


,


r


e


s


.






 ) is below a predefined defined threshold.
For model tuning and gas path diagnostics purpose, correcting factors for the component performance parameters i.e., efficiencies, flow capacities, and effectiveness were included in the MGT model. These factors are included as state variables along with their corresponding target variables. Then, a new Jacobian matrix is built, and new residuals are generated between output variables and target values (
Table 2
) to achieve a solution.
In this case, the standard matching scheme is modified to fit the required state variables. The correcting factor on the flow capacity for compressor and turbine is varied to satisfy the mass flow continuity in these two components. Once the flow capacity is fixed, the beta lines in the compressor and turbine maps are varied to match the desired exit pressure/temperature. The correction factor on the compressor efficiency is varied to match the torque on the shaft, while the speed factor becomes the variable that minimizes the residual between produced power and load demand.
As noted previously, due to the high manufacturing tolerances, MGT components show wide variations in performance characteristics which result in engine to engine performance deviations. Hence, a baseline or nominal model to represent all the MGTs in a fleet may lead to inaccuracy in diagnostics. To reduce the model plant mismatch for healthy engines, model tuning is performed by following a tuning scheme, as shown in 
Figure 2
. The scheme is followed to get individual models for each of the MGTs in the fleet. It is important to note here that the model tuning need to be performed for healthy engines operating in nominal conditions.
According to the tuning scheme, the MGT under consideration is operated in test conditions and data are collected. After that, the nominal MGT model is simulated with same test conditions and the results are compared with the measured data. The measured data are fed to the tuneable MGT model which is used to back-calculate the performance deltas to match the measured data from the healthy MGT. The performance deltas are the deviations in components performance parameters, i.e., efficiency and flow capacity of the turbine and compressor, effectiveness and pressure drop of the recuperator. These calculated performance deltas are then used to modify the nominal model to achieve the tuned model.
Typically, diagnostics schemes for gas turbines are based on a multi-level approach that includes data pre-processing, threshold monitoring, sensor fault detection, engine fault detection and isolation, and fault identification [
39
,
40
,
41
]. However, here the focus will be only on fault identification, meaning assessment of fault location and magnitude. The proposed scheme for the diagnostics of individual MGT unit is presented in 
Figure 3
.
The fault diagnostics scheme that is carried out here is based on a modification of the matching scheme previously discussed, where the Jacobian matrix includes additional states (the performance modification deltas) and additional targets (gas path measurements). In addition, a further step founded upon a signature-based algorithm is used to isolate and quantify the detected faults. A nominal model of representative average engine is used to create fault signatures by simulating different component faults that stored in a signature database. The faults are simulated by assuming associated performance deltas and using these deltas in the MGT model for fault simulation. An inventory of faults that are used to build an example signature database is listed in 
Table 3
. The signature database also includes multiple faults that assumed to be occurred at the same time.
The creation of fault database is something that is performed off-line, whereas the rest of the scheme is performed close to real-time. The first step of the real-time diagnostics scheme is based on a modification of the Jacobian matrix and is called analysis by synthesis (AnSyn). During this step, the measurements from an engine under operation are used to calculate any deviation in performance deltas by simulating the adaptive tuned model of the engine in actual operating conditions. The detected deltas can provide a good indication of the fault location and magnitude for single or multiple faults in compressor, turbine and recuperator as listed in 
Table 3
. However, this step cannot detect other faults such as flow leakages, shaft loss, etc. Hence, the signature-based algorithm is also applied here. In the next step, the computed performance deltas are used as inputs in the adapted tuned model at ISA (International Standard Atmosphere) reference conditions, and exchange rates are calculated. The exchange rates are measurement deviations that are converted to ISA reference conditions. Subsequently, a correlation function, as shown in Equation (
9
), is used to find the correlations between engine exchange rates and the signatures from the database. The correlation function calculates the Pearson Product-Moment Correlation Coefficient (PPMCC) for two sets of values, in this case signatures from measurements and database.








C


o


r


r




(


x


,


y


)




=










∑




i


=


1




k






(




x




n


,


i






−






x


¯




n




)






(


y


−






y


¯




i




)


















∑




i


=


1




k








(




x




n


,


i






−






x


¯




n




)




2




















∑




i


=


1




k








(


y


−






y


¯




i




)




2






















(16)




Here, 




C


o


r


r


(


x


,


y


)




 is referred as the correlation coefficient. In the correlation function, subscript 
i
 is used to denote the series of sensor measurements where 
k
 is the total number of available measurements from the engine. 




x


n




 refers to the signature resulted by the fault in 
n
th component and 
y
 refers to the exchange rates at a given operating point.
The maximum correlations give the location of the fault. To get the magnitude of the faults, Equation (
17
) is solved in an iterative way to determine the coefficient estimates 




c


m




 that give the magnitude of the corresponding faults.










Y




(


x


)




=




∑




i


=


1




l






c


m






X


m














(17)




Here, 




X


m




 and 
Y
 are the vectors that consists of signatures and exchange rates for specific faults which are indicated by the maximum correlation. Subscript 
l
 refers to the number of faults and 
m
 corresponds to a specific fault. Linear regression is employed to solve the above equation and determine the magnitude for single and multiple faults.
To prove the effectiveness of the proposed diagnostics scheme, in this work, the developed MGT model is used to generate measurements related to different faults.
Here, the findings from the gas path modelling and diagnostics, and their inferences are elaborated in detail. At first, the modelling error are presented against the performance test results of a commercial MGT unit. Thereafter, the proposed diagnostics scheme is demonstrated by formulating different case studies, which is complemented by sensitivity studies for different measurement uncertainties, i.e., sensor noise and bias.
In 
Table 4
, the model outputs at nominal load are compared with the corresponding values from performance test results of a commercial scale MGT unit. As it can be seen, the simulated model have acceptable accuracy at the nominal load. It is important to note that the diagnostics scheme tested in this paper is applied only at nominal load.
The model outputs for three other off-design points at part-load are also compared with the performance test results. The comparison results are presented in 
Figure 4
 as percentage error. It can be observed that the speed (
N
) and the turbine outlet temperature (




T


5




) give zero error. This is in-line with the matching scheme described in 
Section 3.1.1
, where 
N
 and 




T


5




 are used as target variables. The error in shaft power (PWX) becomes positive and then negative as the power moves from nominal value to part-load. The shaft power was not available directly from the performance test, and it was calculated from the electrical power output. Assumptions were made about auxiliary power consumption, generator efficiency, and inverter efficiency, these can be contributed to the mismatch between simulated and experimental data.
The error in the compressor outlet pressure (




P


2




) increases as power decreases. The compressor and turbine maps used here are the maps supplied by the turbocharger manufacturer; hence, they are not corrected for the modifications performed to the turbine and compressor. This might explain some of the errors in off-design operating points including 




P


2




. Finally, the recuperator effectiveness was assumed to be constant over entire operating range. This could potentially be responsible for error in recuperator cold side outlet temperature (




T


3




). Overall, the results demonstrate a sufficient agreement between the simulation results with the performance test results for off-design operating points.
To demonstrate the diagnostics scheme described in 
Section 3.3
, two sets of case studies were formulated: one with only single faults occurring one at a time, and the other with multiple faults occurring concurrently. For the first set (




S


1




 to 




S


7




), faults listed in 
Table 3
 are considered, but the fault magnitudes are assumed to be 1.5% instead of 1% as used for the signature database. The results from the AnSyn step and the signature-based algorithm are presented below.
In 
Figure 5
, the location and magnitude of all the single faults except the flow leakage and the shaft loss can be detected in the AnSyn step. This can be explained by looking at the matching scheme used for gas path component diagnostics as elaborated in 
Section 3.1.2
. The modified Jacobian matrix (
Table 2
) includes performance deltas and their corresponding measurement pairs for the compressor, the turbine and the recuperator. However, there are no target-state pairs considered for the flow leakage and the shaft loss. This necessarily means that these faults will be detected during the AnSyn as multiple performance deviations. In these cases, in the AnSyn an equivalent fault is created by distributing the fault effects among other performance deltas that are included in the matching scheme. Alongside, the flow leakage and the shaft loss only affect turbine and recuperator deltas. This is because the GPA measurements corresponding to the compressor deltas are not affected by these two faults. However, due to the measurement uncertainties, compressor deltas are also expected to be affected marginally in reality.
It should be noted here that the AnSyn detects general performance deviations in all fault cases, without identifying the cause of the deviation. In some cases, deviations in efficiency and flow capacity can be directly related to a specific fault (e.g., compressor fouling or turbine erosion or recuperator fouling), while other faults such as flow leakage or additional shaft loss cannot be directly linked to the results from the AnSyn. Hence, a second step based on signature correlation is necessary. In reality, occurring faults will always have effect on more than one delta (e.g., compressor fouling reduces both efficiency and flow), but all the faults will correspond to deviations in the five performance parameters here presented, making AnSyn effective for fault detection. For consequent fault isolation and identification, without the need of increasing the number of required measurements, a second layer of fault diagnostics is applied. This second layer is the signature-based algorithm that includes correlation and regression analysis for fault localization and magnitude quantification respectively. 
Table 5
 shows the correlation coefficients between exchange rates and signatures for case studies with single fault. It is found that, for all the cases, the maximum correlation coefficient always leads to correct location of the fault and thus is placed diagonally in the table. One observation from this study is that the faults corresponding to turbine isentropic efficiency loss and shaft loss have very close correlation coefficients, as red numbers in 
Table 5
. This is quite obvious, since for a fixed turbine pressure ratio, both parameters highly depend on the ratio between actual isentropic enthalpy drop across turbine. However, a better decision about the fault location can be made by merging results from AnSyn and correlation steps.
Once the location of the fault is known, linear regression is applied to get the magnitude of the corresponding fault. Fault magnitudes estimated by the linear regression for the single faults cases are listed in 
Table 6
. It is observed that linear regression resulted in faults magnitude that is very close to the actual simulated faults.
The second set of case studies (




M


1




 to 




M


7




) that includes multiple faults are listed in 
Table 7
. The magnitudes of the faults are chosen between 1% and 1.5% so that the combination is different from the signature database where all the faults are 1% in magnitude.
Results from the AnSyn for simultaneously occurring multiple faults are displayed in 
Figure 6
. As expected, AnSyn can identify correct fault locations and magnitudes for all cases except those including flow leakage and shaft loss. However, when these faults are combined with compressor’s faults, corresponding compressors deltas can be correctly identified by the AnSyn.
The correlation coefficients between exchange rates and signatures for the above cases are reported in 
Table 8
. For each case, this step gives maximum correlation for corresponding signatures from the database that reveals the location of the faults correctly.
Table 9
 summarizes the estimated magnitudes of faults for different cases with multiple faults by regression analysis and the comparison with AnSyn. As can be seen, the regression can give good indication of faults magnitude with some level of error, but the AnSyn performs better. The accuracy can be further improved by including more measurements in the multiple linear regression. However, a limited number of measurements are available in reality for such analysis. Additionally, if a sensor fault occurs and one or more measurements need to be removed from the scheme, the accuracy of the regression can even deteriorate. Sensor faults will also reduce the fault detectability by the AnSyn, since corresponding performance delta for the removed measurement also need to be removed from the matching scheme, as presented in 
Table 2
.
Overall, the results presented until now show that the proposed diagnostics scheme can be used to detect the location and magnitude of different component faults with acceptable accuracy. Combining results from AnSyn with the signature-based algorithm increases the confidence on the final outcome of the proposed scheme. However, the above analysis thus far does not include any measurement uncertainty (i.e., sensor noise and bias), which can be quite common in reality. Hence, the influence of measurement uncertainty on the proposed fault diagnostics scheme is assessed in the following section.
First, the influence of measurement uncertainty on the AnSyn is examined by performing a sensitivity analysis. Here, the measurements corresponding to each of the performance deltas, as listed in 
Table 2
, are varied within measurement uncertainty range. The measurement uncertainties used in this paper are obtained from the literature [
42
,
43
]. It is considered here that 




P


5




 measurement is available through a differential pressure sensor across recuperator.
Figure 7
 shows sensitivity analysis of measurement uncertainties on all five performance deltas. Here, case study 




"


S


1


"




 i.e., 1.5% drop in compressor isentropic efficiency is considered for this analysis. As can be seen in 
Figure 7
, the compressor isentropic efficiency is only affected by 




P


2




 and 




T


2




 measurements. However, there is very strong linkage between 




P


2




 and compressor flow capacity, and 




P


5




 and recuperator effectiveness. Hence, measurement uncertainties in 




P


2




 and 




P


5




 can give misleading indication of faults related to compressor flow capacity and recuperator effectiveness, respectively; although their magnitudes are not as prominent as the fault. Other measurement uncertainties have negligible influence on different performance deltas. Therefore, it can be summarized from the sensitivity analysis that the influence of measurement uncertainties is limited and will have the effect of a reduced accuracy in fault magnitude estimation. Moreover, the sensor data can be filtered before using it for diagnostics purpose to decrease false alarm due to sensor noise related uncertainties.
Thereafter, the effect of measurement uncertainties on the correlation step is assessed. As in the previous section, the case study 




"


S


1


"




, i.e., 1.5% drop in compressor isentropic efficiency is considered. For each of the sensors, maximum deviation in the measurement is assumed. As can be seen in 
Table 10
, the measurement uncertainties has influence on the correlation coefficient. However, the influence is negligible and still faults are identified correctly by giving maximum correlation coefficient for corresponding fault location.
Eventually, the influence of measurement uncertainties on the fault magnitude detection by using linear regression is examined with the help of sensitivity analysis. The sensor measurements are varied by introducing different level of uncertainties and the corresponding fault magnitudes are calculated for case study 




S


1




. The result of the analysis is summarized in 
Figure 8
. The most influencing measurement uncertainty in this case corresponds to 






T


2






 and 






T


3






. Despite the high sensitivity for some measurements, the regression can still provide fault magnitude with acceptable accuracy.
In this article, a multi-layer approach for monitoring and diagnostics of MGT fleet is investigated. A diagnostics-oriented model based on gas path analysis lies at the core of this approach. Subsequently, a model tuning approach is proposed to account for engine to engine variation as a result of production scatter. The two layers of diagnostics approach that are investigated in this paper include: (1) analysis by synthesis (AnSyn); and (2) signature based algorithm to detect the location and magnitude of different component faults. To perform AnSyn, performance deltas corresponding to each component fault are introduced in the physics-based model, where each delta is associated with a measurement of the engine. The performance deltas are then calculated by using real-time measurements from the engine that gives both location and magnitude of the fault. Due to the lack of measurements, not all the faults can be included in the AnSyn step. Moreover, to improve the robustness of the diagnostics approach, a signature based algorithm is applied as the second layer. Fault signatures were generated with the engine model and compared with the simulated faulty engine data. Correlation function and linear regression are applied to get the location and magnitude of the faults, respectively. Finally, results from both layers are merged together. The proposed diagnostics scheme was tested by formulating case studies corresponding to single and multiple faults. Furthermore, sensitivity studies were performed for different measurement uncertainties (i.e., sensor noise and bias) to evaluate the robustness of the scheme against measurement uncertainties. The result shows that the proposed diagnostics approach performs satisfactorily even under measurement uncertainties. Overall, magnitude of triple faults seems hard to detect by signature based algorithm, given that the number of measurements available for the analysis is limited to five. The accuracy can be improved by including more measurements in the analysis. In case of sensor faults, the corresponding measurements need to be removed from the matching scheme for AnSyn along with their associated performance deltas. This will unavoidably reduce the detectability of the corresponding fault by AnSyn. At the same time, the signature based algorithm might result in reduced accuracy or false alarm. 
M.R. and V.Z. outlined the paper and designed the case studies; M.R. performed the simulations, analysed the results and wrote the paper; X.Z. contributed through EVA code modification; and K.K. and V.Z. supervised the work.
This research was funded by European Commission under Horizon 2020 programme, grant number 723523.
The authors gratefully acknowledge the financial support from European Commission under Horizon 2020 programme, SPIRE-02-2016 through FUDIPO project (
http://fudipo.eu/
). The authors also thank Mikael Stenfelt of Malardalen University and Mark Oostveen of MTT BV for their continuous support.
The authors declare no conflict of interest.
The following abbreviations are used in this manuscript: