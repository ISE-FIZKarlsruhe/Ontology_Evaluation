We provide a new method to represent all potential flowsheet configurations for the superstructure-based simultaneous synthesis of work and heat exchanger networks (WHENS). The new representation is based on only two fundamental elements of abstract building blocks. The first design element is the block interior that is used to represent splitting, mixing, utility cooling, and utility heating of individual streams. The second design element is the shared boundaries between adjacent blocks that permit inter-stream heat and work transfer and integration. A semi-restricted boundary represents expansion/compression of streams connected to either common (integrated) or dedicated (utility) shafts. A completely restricted boundary with a temperature gradient across it represents inter-stream heat integration. The blocks interact with each other via mass and energy flows through the boundaries when assembled in a two-dimensional grid-like superstructure. Through observation and examples from literature, we illustrate that our building block-based WHENS superstructure contains numerous candidate flowsheet configurations for simultaneous heat and work integration. This approach does not require the specification of work and heat integration stages. Intensified designs, such as multi-stream heat exchangers with varying pressures, are also included. We formulate a mixed-integer non-linear (MINLP) optimization model for WHENS with minimum total annual cost and demonstrate the capability of the proposed synthesis approach through a case study on liquefied energy chain. The concept of building blocks is found to be general enough to be used in possible discovery of non-intuitive process flowsheets involving heat and work exchangers.
Heat and work are used as the primary energy utilities in most chemical process plants. Both heat and work are interchangeable, and it is imperative that we consider them together when we perform energy integration. In this regard, the work and heat exchanger network synthesis (WHENS) is a class of design problems that aims to simultaneously optimize heat and work exchangers and their networks [
1
,
2
,
3
]. WHENS improves energy efficiency and brings economic benefits to energy systems [
4
]. Significant research has been done in the past in heat exchanger network synthesis (HENS) [
5
]. Work exchange network synthesis (WENS) [
6
,
7
,
8
,
9
,
10
,
11
] has also gained attention in recent years. However, WHENS problems are more challenging compared to individual HENS and work exchange network (WEN) problems [
2
]. Fu and Gundersen [
12
] defined a WHENS problem as follows: “Given a set of process streams with supply and target states (temperature and pressure), as well as utilities for power, heating and cooling; design a work and heat exchange network of heat transfer equipment such as heat exchangers, evaporators and condensers, as well as pressure-changing equipment such as compressors, expanders, pumps and valves, in such a way that the exergy consumption is minimized or the exergy production is maximized”. Apart from exergy, other objectives of WHENS may include cost minimization, utility reduction, and equipment reduction.
An indicative list of recent contributions in WHENS research is provided in 
Table 1
. These contributions can be broadly classified into pinch technology-based graphical approaches and mathematical programming-based optimization approaches. Pinch analysis relies on fundamental thermodynamic insights and involves appropriate placement [
13
] and grand composite curves [
14
,
15
,
16
]. Though significant progress has been made in terms of theoretical development [
17
,
18
] and methodological advances [
19
,
20
], there are several limitations of pinch analysis. Firstly, this approach is time-consuming when applied to systems involving many process streams [
2
]. Secondly, the stream identity (hot/cold, high/low-pressure) and the starting and final states of each process stream must be specified 
a
 




p


r


i


o


r


i




. Mathematical programming-based optimization approaches, e.g., refs. [
3
,
21
,
22
,
23
,
24
], overcome some of these limitations. However, they require a suitable representation of all candidate network configurations. This can be done by developing a superstructure, which is a giant flowsheet incorporating many alternative configurations [
25
,
26
,
27
]. To this end, a comprehensive but intelligent representation of the superstructure is critical to include as many network configurations and flowsheet candidates as possible, while keeping the corresponding mathematical program computationally tractable [
28
].
There exist several superstructure representations in the WHENS literature [
23
], e.g., state-space representation [
29
], multi-stage superstructure [
3
,
24
] and representation involving heuristics [
30
]. However, these superstructures suffer from several fundamental limitations. Firstly, one needs to pre-postulate all equipment configurations in the superstructure based on existing knowledge of unit operations, engineering experience and heuristics. If one excludes the best configuration as one of the alternatives in the superstructure, then it will be never discovered. Given the complexity, interchangeability and trade-offs between work and heat exchange networks, this inability to incorporate innovation could sometimes result in inferior solutions. With increasing competitions and awareness for energy sustainability, there is a need for incorporating novel and “out-of-the-box” solutions when solving a WHENS problem.
Secondly, pathways leading to novel intensified designs are neglected in classic superstructure representations. Process intensification refers to significant reduction of equipment sizes, waste generation, and increase of productivity [
31
]. New opportunities could arise in WHENS through incorporating process intensification principles. It can bring about new technologies which are smaller, cleaner, safer, and more energy-efficient [
32
,
33
,
34
]. To this end, the goal of WHENS and process intensification are often complementary to each other. For example, one could use a multi-stream heat exchanger (MHEX) instead of two-stream exchangers that would reduce the number of equipment and, at the same time, would improve the overall performance of a work-heat exchange network. Few works considered incorporating MHEXs in heat integration. Hasan et al. exploited a stagewise superstructure to find the optimal heat exchanger network (HEN) that best represents the operational of MHEXs using historical data [
35
]. Rao and Karimi addressed MHEXs based on a single-stage superstructure consisting of two-stream exchangers [
36
].
To summarize, a key challenge in WHENS is to systematically discover and screen both existing and novel, classic and intensified alternative configurations. Superstructure provides an excellent means to automatically generate many network configurations, but the traditional superstructures could still miss innovative solutions due to a lack of representation. To this end, Hasan and co-workers have recently put forward a novel superstructure representation using abstract building blocks for systematic process synthesis and intensification [
37
,
38
,
39
,
40
]. With a generic block representation, there is no need to pre-specify the stream and equipment identities and flowsheet configurations. Streams can intermittently change their identities as needed. Classical and intensified equipment are configured automatically. Furthermore, there is no need to specify any work and heat integration stages. Therefore, the block representation could potentially avoid the above limitations when applied to WHENS.
In this work, we formalize and employ the concept of abstract building blocks to represent all alternative configurations within a superstructure for synthesis problems involving simultaneous work and heat integration (WHENS). The remaining of the article is structured as follows. First, we elaborate the representation of work and heat exchange networks using building blocks in 
Section 2
. Next, we present a mixed-integer nonlinear formulation (MINLP) for WHENS in 
Section 3
. We demonstrate the applicability of our approach with a case study on WHENS in 
Section 4
. Finally, we present some concluding remarks.
WHENS is more complex than HENS and WENS. HENS involves several specified hot and cold streams with initial and final temperatures. A hot stream undergoes successive cooling either using a cold utility (e.g., cooling water or a refrigerant) in coolers or through exchanging heat with one or more cold streams using heat exchangers. Similarly, a cold stream undergoes successive heating either through using a hot utility (e.g., steam) or through directly integrating heat with one or more hot streams. Heat can be also recovered from hot streams using a working fluid which then transfers that heat to cold streams. Similar to HENS, WENS involves high-pressure and low-pressure streams with specified flow rates and initial and final pressure ratings. A high-pressure stream undergoes successive release in pressure through valves or expanders. A low-pressure stream undergoes successive compression using movers such as pumps and compressors. If the movers are dedicated to individual streams and use single shafts, then they need utility (e.g., electricity, steam turbine). However, if an expander and a compressor share a common shaft, then the shaft work generated by the expander is integrated with the compressor. Thus, an integration of work is achieved. Unlike HENS and WENS, WHENS involves process streams that might undergo both temperature and pressure changes (sometimes in multiple stages) to achieve the target temperature and pressure ratings. Therefore, WHENS involves more than two types of streams, which can be initially (i) hot and high-pressure; (ii) hot and low-pressure; (iii) cold and high-pressure; (iv) cold and low-pressure; and (v) neutral (e.g., a refrigerant circulating through multiple equipment in a refrigeration cycle). Furthermore, the interchangeability of work and heat is often reflected in an intermittent change of stream identities. For example, an initially hot and high-pressure stream may become a cold and low-pressure stream after excessive expansion. Similarly, an initially cold stream can later become a hot stream through compression.
The goal in WHENS is to identify the optimal unit operations and equipment sizing involving mixing, splitting, cooling, heating, pressurizing, and depressurizing (note that inter-stream mixing is not allowed). In this section, we first describe how we can create representations for different types of unit operations in WHENS by using only two fundamental design elements of abstract building blocks, namely a block interior and a block boundary. We then discuss the details of building blocks and the construction of a block-based WHENS superstructure.
The new representation is based on the concept of “abstract building blocks” originally proposed by Hasan and co-workers for general process design, integration and intensification [
37
,
38
,
39
]. Each building block has two fundamental design elements. The first design element is the block interior that is used to represent splitting, mixing, utility cooling and utility heating of individual streams (
Figure 1
a). Each block interior is assigned with a temperature, a pressure, a composition, and a phase. The second design element is the shared boundaries between two adjacent blocks that permit inter-stream heat and work transfer and integration. Specifically, each block has four boundaries (left, right, top and bottom). Each of these boundaries can be one of the three types: unrestricted, semi-restricted, and completely restricted (
Figure 1
b). An unrestricted boundary is assigned when the two blocks sharing this boundary have the same pressure and composition (temperatures and phases can be different). A semi-restricted boundary represents expansion/compression of a stream while leaving a block to another with a different pressure. The pressurizing/depressurizing is done through either common (integrated) or dedicated (utility) shafts. (Please note that, in the original representation of Demirel et al. [
37
], a semi-restricted boundary assumes a more general task as an interface for mass/heat/energy transfer. In WHENS, we need it only to represent work transfer, which simplifies the model). A completely restricted boundary between two blocks with a temperature gradient represents inter-stream heat integration using a common heat exchanger (e.g., shell and tube exchanger with the cold fluid in the shell-side and the hot fluid in the tube-side).
Using the basic concepts of a building block as described above, we can represent more intricate and complex processes. To do this, we need to orient multiple blocks in a two-dimensional grid-like structure. These blocks will interact with each other via mass and energy flows through various boundaries, and automatically generate many alternative equipment and flowsheet configurations.
For example, 
Figure 2
a shows a block representation and its corresponding flowsheet configuration of an operation involving a single stream undergoing a pressure change. The block representation is given by two blocks 




B




1


,


1






 and 




B




1


,


2






, separated by a semi-restricted (blue) boundary. (From now on, 




B




i


,


j






 will represent a block placed in row 
i
 and column 
j
). The stream with pressure 




P


1




 is fed into block 




B




1


,


1






 and goes through the boundary to achieve the target pressure 




P


2




. Depending on the inlet and outlet pressures, this boundary is assigned with an expander/valve (when 




P


1




 ≥ 




P


2




) or a compressor (when 




P


1




 ≤ 




P


2




). In 
Figure 2
b, two high-pressure streams, (
HP






1




 and 
HP






2




) are integrated with a low-pressure stream (
LP






1




). These two high-pressure streams pass through two expanders 




E


x




p


1






 and 




E


x




p


2






 respectively to achieve the desired pressure. The pressure of stream 
LP






1




 is increased to the target pressure after two compressors (




C


o




m


1






 and 




C


o




m


2






). The corresponding block representation involves 




3


×


3




 building blocks. Feed 
HP






1




 is supplied into block 




B




1


,


1






 and withdrawn as product in block 




B




1


,


2






 while feed 
HP






2




 is supplied into block 




B




1


,


2






 and withdrawn as product in block 




B




2


,


2






. The low-pressure stream 
LP






1




 is fed into block 




B




1


,


3






 and withdrawn from block 




B




3


,


2






. Please note that there are four semi-restricted boundaries in this block representation, which include the right boundaries of block 




B




1


,


1






, 




B




2


,


1






 and 




B




3


,


2






 and the bottom boundary of block 




B




1


,


3






. Specifically, the right boundaries of block 




B




1


,


1






 and block 




B




2


,


1






 are assigned with expanders. The bottom boundary of block 




B




1


,


3






 and the right boundary of 




B




3


,


2






 are assigned with compressors. The expander at right boundary of block 




B




1


,


1






 and the compressor at the right boundary of block 




B




3


,


2






 are sharing shaft 1 (both are marked as blue). The expander at right boundary of block 




B




2


,


1






 and the compressor at bottom boundary of block 




B




1


,


3






 are sharing shaft 2 (both are marked as red). For illustration purpose, the boundary between block 




B




2


,


3






 and block 




B




3


,


3






 is specified as unrestricted boundary, where the pressure 




P




2


,


3






 and 




P




3


,


3






 are the same.
In the case of heat exchange (
Figure 2
c), a cold stream 




C


1




 is integrated with a hot stream 




H


1




 through a heat exchanger. Two equivalent block representations are presented. On involves a representation with two blocks. The left block allows the entering of cold stream 




C


1




 and produces the product stream with the desired temperature. Hot stream 




H


1




 enters the right block and is withdrawn from the same block. This heat exchanger is represented through a completely restricted boundary between block 




B




1


,


1






 and 




B




1


,


2






. The energy flow is transferred from block 




B




1


,


2






 to block 




B




1


,


1






. Another representation involves more blocks but better captures the relation of temperature change. Cold stream 




C


1




 enters block 




B




1


,


1






 with inlet temperature as 




T




1


,


1






 and flows into block 




B




1


,


2






 with target temperature as 




T




2


,


1






. Hot stream 




H


1




 enters block 




B




1


,


2






 with inlet temperature as 




T




1


,


2






 and is withdrawn from block 




B




2


,


2






 with temperature as 




T




2


,


2






. The right boundary of block 




B




2


,


1






 is a completely restricted boundary. As shown in 
Figure 2
d, a block with multiple completely restricted boundary can represent an MHEX. The cold stream 




C


1




 enters block 




B




1


,


2






 and takes heat from hot stream 




H


1




 in block 




B




1


,


1






 and from hot stream 




H


2




 in block 




B




1


,


3






.
As we add more blocks in the 2-D grid assembly, we enlarge the space for representing more and more equipment and flowsheet alternatives in a single structure. The versatility of the block representation can be seen in 
Figure 3
, where blocks are used to represent WHENS superstructures taken from a range of literature problems such as separation system for propane and propylene [
24
], liquefied energy chain [
24
,
29
], general work and heat integration process [
13
], and single mixed refrigerant (SMR) process [
45
]. For instance, the separation system involving three process streams 




S


1




, 




S


2




 and 




S


3




 is represented by a block representation with 




i


=


5




 and 




j


=


4




 to involve all connectivities for work and heat integration. 




S


1




 enters block 




B




2


,


1






 and flows through a valve before entering block 




B




3


,


1






. 




S


2




 with varying identity is supplied into block 




B




2


,


3






 and is compressed at the bottom boundary of block 




B




2


,


3






. The heat transfer happens at right boundary of block 




B




3


,


1






 between stream 




S


1




 and stream 




S


2




, right boundary of 




B




2


,


2






 between cold side of 




S


2




 and hot side of 




S


2




, right boundary of 




B




4


,


3






 between stream 




S


2




 and 




S


3




 and right boundary of 




B




5


,


4






 between stream 




S


2




 and stream 




S


3




.
A process with multi-stream heat exchanger is shown in 
Figure 3
d. The natural gas (NG) feed enters block 




B




2


,


1






 and flows into the block 




B




3


,


1






 with its right boundary as completely restricted boundary. The NG stream goes through a valve assigned on the bottom boundary of block 




B




3


,


1






 before entering block 




B




5


,


1






 with a flash boundary. The details of these separation boundaries can be found in Li et al. [
38
] Refrigerant flow enters block 




B




2


,


2






 and undergoes sequential compression and cooling in block 




B




1


,


2






, 




B




1


,


3






, 




B




1


,


4






 and 




B




2


,


4






. The outlet stream from block 




B




3


,


4






 serves as a hot stream, supplying heat to the same stream after valve operation at the right boundary of block 




B




4


,


2






. The MHEX is represented by a block, i.e., 




B




3


,


2






 with two completely restricted boundary. Based on the representation approach, we develop the corresponding MINLP model for WHENS, which is discussed in the next section.
As shown in 
Figure 2
 and 
Figure 3
, the block representation indicates towards a unified approach for WHENS while accounting for the interplay of pressure and temperature. As we infer more, a generalized two-dimensional grid-like orientation of building blocks can be used to contain numerous flowsheet configurations for simultaneous heat and work integration. To this end, our block-based WHENS superstructure is shown in 
Figure 4
. This representation consists of building blocks arranged in a grid with 
I
 number of rows and 
J
 number of columns. Feed 
f
 with component flowrate as 




M




i


,


j


,


k


,


f






 and product streams 
p
 with component flowrate as 




H




i


,


j


,


k


,


p






 are potentially supplied into or withdrawn from block 




B




i


,


j






. Each block has temperature and pressure attributes as 




T




i


,


j






 and 




P




i


,


j






. These blocks are connected to each other through adjacent connecting streams 




F




i


,


j


,


k


,


d






 and jump connecting streams 




J




i


,


j


,




i


′




,




j


′




,


k






 (see black arrows and gray arrows in 
Figure 4
a respectively).
Each adjacent connecting stream has both positive and negative components as 




F




P




i


,


j


,


k


,


d








 and 




F




N




i


,


j


,


k


,


d








 to allow more network alternatives. 




F




P




i


,


j


,


k


,


d








 designates the flow from block 




B




i


,


j






 to block 




B




i


,


j


+


1






 in horizontal direction (




d


=


1




 ) or the flow from block 




B




i


+


1


,


j






 to block 




B




i


,


j






 in vertical direction (




d


=


2




). 




F




N




i


,


j


,


k


,


d








 designates the flow from block 




B




i


,


j


+


1






 to block 




B




i


,


j






 in horizontal direction (




d


=


1




 ) or the flow from block 




B




i


,


j






 to block 




B




i


+


1


,


j






 in vertical direction (




d


=


2




). Besides, jump flow from block 




B




i


,


j






 to block 




B






i


′




,




j


′








 with component flowrate as 




J




i


,


j


,




i


′




,




j


′




,


k






 is introduced to avoid unnecessary intermediate blocks for transferring material and energy flow, where 




i


′




 and 




j


′




 designate the row and column position of a different block in the block superstructure.
Adjacent blocks are separated via unrestricted, semi-restricted or completely restricted boundary. Both unrestricted and semi-restricted boundaries allow mass and energy flow. The thermodynamic driving force at these boundaries enables the changes of temperature and pressure. Unrestricted boundary allows mass and energy flow while ensuring the inlet pressure equal to outlet pressure, i.e., the block pressure 




P




i


,


j






 in adjacent blocks separated by unrestricted boundary are the same. Semi-restricted boundary allows pressure change between adjacent blocks and hence indicates the existence of a pressure exchanger, i.e., compressors, expanders, or valves (shown in 
Figure 4
b gray box). Completely restricted boundary prohibits mass flow while allowing energy flow (shown in 
Figure 4
b black box). The existence of completely restricted boundary indicates a heat exchanger between two streams in the adjacent blocks. When a block includes more than one completely restricted boundaries, this block can be regarded as an MHEX. The inlet pressure for pressure exchangers are 




P




i


,


j






 when the adjacent connecting streams across the semi-restricted boundary are outlet flow from block 




B




i


,


j






. The outlet pressure for these pressure exchangers are 




P




i


,


j


+


1






 in horizontal direction and 




P




i


+


1


,


j






 in vertical direction when 




F




i


,


j


,


k


,


d






 is coming out from block 




B




i


,


j






. The block temperature 




T




i


,


j






 is the temperature of outlet streams from block 




B




i


,


j






. With the block temperature 




T




i


,


j






 and pressure 




P




i


,


j






, the unit enthalpy 




E




H




i


,


j


,


k








 in block 




B




i


,


j






 for component 
k
 can be determined. In addition to the heat transfer happening at completely restricted boundary, each block also allows external utility stream to supply extra heat duty 




Q




i


,


j




h




 or cold duty 




Q




i


,


j




c




.
We now present an MINLP model for WHENS using building block-based superstructure. The overall problem is described as follows. When given a set 




F


S


=


{


f


|


f


=


1


,


.


.


.


,


|


F


S


|


}




 of inlet process streams with temperature and pressure specifications as 




T


f




f


e


e


d






 and 




P


f




f


e


e


d






, and a set 




P


S


=


{


p


|


p


=


1


,


.


.


.


,


|


P


S


|


}




 of outlet process streams with target temperature and pressure ranges as [




T


p




m


i


n






, 




T


p




m


a


x






] and [




P


p




m


i


n






, 




P


p




m


a


x






], respectively, synthesize the optimal work and heat exchanger network that minimizes the total annual cost. The MINLP model will involve block material and energy balances, flow directions, work calculations, phase relations, boundary and task assignments, and logic constraints. The known flowrates of inlet process streams is designated as 




F


f




f


e


e


d






. The objective is to synthesize a work and heat exchanger network that captures the interplay of pressure and temperature to minimize the total annual cost. The set 




D


=


{


d


|


d


=


1


,


2


}




 designates the flow alignment. The flow alignment 




d


=


1




 when the stream is flowing in the horizontal direction, i.e., from block 




B




i


,


j






 to 




B




i


,


j


+


1






; 




d


=


2




 when the stream is flowing in the vertical direction, i.e., from block 




B




i


,


j






 to 




B




i


+


1


,


j






. The temperature range and flowrate range for all connecting flows including direct connecting flow and jump connecting flow is set as [




T




m


i


n






, 




T




m


a


x






] and [




F


L




, 




F


U




] respectively. The assumptions for this work are continuous steady-state operation, adiabatic expansion/compression, and linear relation of stream enthalpy with pressure and temperature. With these, we now describe the MINLP model for WHENS based on block superstructure.
The generic material balance is imposed on each individual block. The inlet flow for component 
k
 at block 




B




i


,


j






 includes horizontal inlet flow 




F




i


,


j


-


1


,


k


,


1






, vertical inlet flow 




F




i


-


1


,


j


,


k


,


2






, external feed stream 




M




i


,


j


,


k




f




, and inlet stream via jump flow 




J




i


,


j


,


k




f




. The outlet flow for component 
k
 at block 




B




i


,


j






 includes the horizontal outlet flow 




F




i


,


j


,


k


,


1






, vertical outlet flow 




F




i


,


j


,


k


,


2






, external product stream 




H




i


,


j


,


k




p




 and outlet stream via jump flow 




J




i


,


j


,


k




p




.
We set 






F




i


=


I


,


j


,


k


,


1






=




F




i


,


j


=


J


,


k


,


2






=


0




 to avoid other interactions between the superstructure and the environment except those through external feeds and products. External feed stream of component 
k
, 




M




i


,


j


,


k




f




, collect the component flowrate, 




M




i


,


j


,


k


,


f






, from all available feed 
f
. External product stream 




H




i


,


j


,


k




p




 is the summation of component flowrate, 




H




i


,


j


,


k


,


p






, from all possible product stream 
p
 in block 




B




i


,


j






. Similarly, 




J




i


,


j


,


k




f




 and 




J




i


,


j


,


k




p




 are determined from the jump connecting flow 




J




i


,


j


,




i


′




,




j


′




,


k






. These are achieved through the following constraints.











M




i


,


j


,


k




f




=




∑




f


∈


F


S








M




i


,


j


,


k


,


f








i


∈


I


,


j


∈


J


,


k


∈


K










(2)














H




i


,


j


,


k




p




=




∑




p


∈


P


S








H




i


,


j


,


k


,


p








i


∈


I


,


j


∈


J


,


k


∈


K










(3)














J




i


,


j


,


k




f




=




∑




(




i


′




,




j


′




)


∈


L


N








J






i


′




,




j


′




,


i


,


j


,


k








i


∈


I


,


j


∈


J


,


k


∈


K










(4)














J




i


,


j


,


k




p




=




∑




(




i


′




,




j


′




)


∈


L


N








J




i


,


j


,




i


′




,




j


′




,


k








i


∈


I


,


j


∈


J


,


k


∈


K










(5)




Here the set 




L


N




 collects all jump connectivities from block 




B




i


,


j






 to block 




B






i


′




,




j


′








.
We define a feed fraction variable 




0


≤




z




i


,


j


,


f






f


e


e


d


f


r


a


c






≤


1




 for feed stream 
f
 in block 




B




i


,


j






. Therefore, the component flowrate through feed 
f
 into block 




B




i


,


j






, 




M




i


,


j


,


k


,


f






 can be determined as follows:










M




i


,


j


,


k


,


f






=




F


f




f


e


e


d








y




k


,


f






f


e


e


d








z




i


,


j


,


f






f


e


e


d


f


r


a


c






,




i


∈


I


,


j


∈


J


,


k


∈


K


,


f


∈


F


S










(6)












0


≤




∑




i


∈


I








∑




j


∈


J








z




i


,


j


,


f






f


e


e


d


f


r


a


c






≤


1


,




f


∈


F


S










(7)





where 




F


f




f


e


e


d






 is the maximum available amount of feed stream 
f
. 




y




k


,


f






f


e


e


d






 is composition of component 
k
 in feed 
f
. Summation of these feed fraction variables will be less than 1 if the overall feed amount is less than 




F


f




f


e


e


d






.
The flowrate range for product stream 
p
 is restricted from minimum product flowrate 




D


p


L




 to maximum product flowrate 




D


p


U




.











D


p


L




≤




∑




i


∈


I








∑




j


∈


J








∑




k


∈


K








H




i


,


j


,


k


,


p






≤




D


p


U




,




p


∈


P


S










(8)




In general, the flowrate range for product stream 
p
 is equal to inlet flowrate, indicating 






D


p


L




=




D


p


U






.
We consider the connecting stream 




F




i


,


j


,


k


,


d






 between adjacent blocks as a bidirectional flow. Its positive and negative components are 




F




P




i


,


j


,


k


,


d








 and 




F




N




i


,


j


,


k


,


d








 respectively. The selection of flow direction is achieved through the following binary variable:










z




i


,


j


,


d






P


l


u


s






=










1










if






F




i


,


j


,


k


,


d








is




from




block






B




i


,


j








to






B




i


,


j


+


1








(




d


=


1




)




or




from




block






B




i


,


j








to






B




i


+


1


,


j








(




d


=


2




)












0










otherwise






















The following constraints ensure that only one component of this connecting stream is activated:










F




i


,


j


,


k


,


d






=


F




P




i


,


j


,


k


,


d






-


F




N




i


,


j


,


k


,


d








i


∈


I


,


j


∈


J


,


k


∈


K


,


d


∈


D










(9)












F




P




i


,


j


,


k


,


d






≤


F


U




z




i


,


j


,


d






P


l


u


s






,




i


∈


I


,


j


∈


J


,


k


∈


K


,


d


∈


D










(10)












F




N




i


,


j


,


k


,


d






≤


F


U




(


1


-




z




i


,


j


,


d






P


l


u


s






)




,




i


∈


I


,


j


∈


J


,


k


∈


K


,


d


∈


D










(11)




Besides, with these stream components, the overall inlet flow is the summation of all incoming streams into block 




B




i


,


j






:










ϕ




i


,


j


,


k






=


F




P




i


,


j


-


1


,


k


,


1






+


F




N




i


,


j


,


k


,


1






+


F




P




i


-


1


,


j


,


k


,


2






+


F




N




i


,


j


,


k


,


2






+




J




i


,


j


,


k




f




+




∑


f






M




i


,


j


,


k


,


f








i


∈


I


,


j


∈


J


,


k


∈


K










(12)




The block energy balance includes stream enthalpy, feed enthalpy, product enthalpy, external heating/cooling, work energy associated with expansion/compression and contacting energy flow across the block boundary. Then the steady-state energy balance for block 




B




i


,


j






 is formulated as follows:








E




B




i


,


j






i


n






-


E




B




i


,


j






o


u


t






+


E




M




i


,


j






-


E




P




i


,


j






+




Q




i


,


j






+




W




i


,


j






+


E




F




i


,


j


-


1


,


1






+


E




F




i


-


1


,


j


,


2






-


E




F




i


,


j


,


1






-


E




F




i


,


j


,


2






=


0




i


∈


I


,


j


∈


J










(13)





where 




E




B




i


,


j






i


n








, and 




E




B




i


,


j






o


u


t








 are inlet enthalpy and outlet enthalpy streams to block 




B




i


,


j






 respectively. 




E




M




i


,


j








 is the overall stream enthalpy carried by feed streams. 




E




P




i


,


j








 is the overall product enthalpy carried by product streams. 




Q




i


,


j






 is the enthalpy supplied by utility streams into block 




B




i


,


j






. 




W




i


,


j






 is the work energy supplied through compression operation or expansion operation for block 




B




i


,


j






 respectively. Besides, 




E




J




i


,


j








 is the stream enthalpy carried along with the jump connecting streams. 




E




F




i


,


j


,


d








 represents the energy flow going through the completely restricted boundary and indicates the amount of heat transfer between adjacent streams. These energy flow variables are shown in 
Figure 5
.
The inlet stream enthalpy to block 




B




i


,


j






 consists of inlet stream enthalpy from adjacent blocks in horizontal directions, i.e., 




E


F


P




s




i


,


j


-


1


,


k


,


1








 and 




E


F


N




s




i


,


j


,


k


,


1








, stream enthalpy from adjacent blocks in vertical directions, i.e., 




E


F


P




s




i


-


1


,


j


,


k


,


2








 and 




E


F


N




s




i


,


j


,


k


,


2








, and stream enthalpy through inlet jump connecting streams, i.e., 




E




J






i


′




,




j


′




,


i


,


j


,


k








. Hence, 




E




B




i


,


j






i


n








 is determined as follows:








E




B




i


,


j






i


n






=




∑


k






(


E


F


P




s




i


,


j


-


1


,


k


,


1






+


E


F


N




s




i


,


j


,


k


,


1






+


E


F


P




s




i


-


1


,


j


,


k


,


2






+


E


F


N




s




i


,


j


,


k


,


2






)




+




∑


k






∑




(


i


,


j


)


∈


L


N






E




J






i


′




,




j


′




,


i


,


j


,


k








∀


i


,


j










(14)




Similarly, the outlet stream enthalpy to block 




B




i


,


j






, 




E




B




i


,


j






o


u


t








 is determined as follows:








E




B




i


,


j






o


u


t






=




∑


k






(


E


F


P




s




i


,


j


,


k


,


1






+


E


F


P




s




i


,


j


,


k


,


2






+


E


F


N




s




i


-


1


,


j


,


k


,


2






+


E


F


N




s




i


,


j


-


1


,


k


,


1






+




∑




(




i


′




,




j


′




)


∈


L


N






E




J




i


,


j


,




i


′




,




j


′




,


k






)






∀


i


,


j










(15)




These stream enthalpies are determined based on the flowrate and the unit enthalpy. For outlet streams from block 




B




i


,


j






 in flow alignment 
d
, the initial unit enthalpy for these streams are the block enthalpy 




E




H




i


,


j


,


k








. For the inlet stream to block 




B




i


,


j






 in horizontal direction with flow alignment 




d


=


1




, the initial unit enthalpy is the unit enthalpy 




E




H




i


,


j


+


1


,


k








 in block 




B




i


,


j


+


1






. For the inlet stream to block 




B




i


,


j






 in vertical direction with flow alignment 




d


=


2




, the initial unit enthalpy is the enthalpy 




E




H




i


+


1


,


j


,


k








 in block 




B




i


+


1


,


j






.









E


F


P




s




i


,


j


,


k


,


d






=


F




P




i


,


j


,


k


,


d






E




H




i


,


j


,


k








i


∈


I


,


j


∈


J


,


k


∈


K


,


d


∈


D










(16)












E


F


N




s




i


,


j


,


k


,


1






=


F




N




i


,


j


,


k


,


d






E




H




i


,


j


+


1


,


k








i


∈


I


,


j


∈


J


,


k


∈


K


,


d


∈


D










(17)












E


F


N




s




i


,


j


,


k


,


2






=


F




N




i


,


j


,


k


,


d






E




H




i


+


1


,


j


,


k








i


∈


I


,


j


∈


J


,


k


∈


K


,


d


∈


D










(18)




The feed stream enthalpy in block 




B




i


,


j






 is based on the flowrate of feed streams and stream enthalpy of feed streams 




E




F


f






.









E




M




i


,


j






=




∑




k


,


f








M




i


,


j


,


k


,


f






E




F


f






i


∈


I


,


j


∈


J


,


k


∈


K


,


f


∈


F


S










(19)








E




F


f






 is a parameter determined by the feed temperature and pressure.
The product stream enthalpy from block 




B




i


,


j






 is based on the flowrate of product streams and stream enthalpy in this block.









E




P




i


,


j






=




∑




k


,


p








H




i


,


j


,


k


,


p






E




H




i


,


j


,


k








i


∈


I


,


j


∈


J


,




(


k


,


p


)




∈


k


p


s










(20)




The utility enthalpy term consists of hot utility, 




Q




i


,


j




h




 and cold utility 




Q




i


,


j




c




, which are supplied into block 




B




i


,


j






.











Q




i


,


j






=




Q




i


,


j




h




-




Q




i


,


j




c






i


∈


I


,


j


∈


J










(21)




To obtain the fixed cost of heaters and coolers, we define the following two binary variables:










z




i


,


j






h


o


t






=










1










if




block






B




i


,


j








involves




hot




utility












0










otherwise






















It is straightforward to relate heat duty of heaters and coolers with these two binary variables:










Q




i


,


j




h




≤


E


U




z




i


,


j






h


o


t






,






Q




i


,


j




c




≤


E


U




z




i


,


j






c


o


d








i


∈


I


,


j


∈


J










(22)




Here 




E


U




 is the upper bound of stream enthalpy.
The work energy is determined by the amount of work added into or taken out of block 




B




i


,


j






, which are denoted as 




W




i


,


j






c


o


m






 for compression and 




W




i


,


j






e


x


p






 for expansion, respectively. The calculation of 




W




i


,


j






c


o


m






 and 




W




i


,


j






e


x


p






 is explained later in this 
Section 3.8
.
The stream enthalpy across the completely restricted boundary is either in the positive direction (






z




i


,


j


,


d






P


l


u


s






=


1




) or in the negative direction (






z




i


,


j


,


d






P


l


u


s






=


0




).
We define binary variables for each product stream 
p
 at block 




B




i


,


j






 to determine whether they are active in 




B




i


,


j






 or not:










z




i


,


j


,


p






p


r


o


d


u


c


t






=










1










if




product




stream




p




is




withdrawn




from




block






B




i


,


j
















0










otherwise






















The identification of block as product block is achieved through the following logical relation, which involves product binary variable.
For each block, there are at most one type of product stream present in block 




B




i


,


j






. The logic proposition is illustrated as follows:










∑




p


∈


P


S








z




i


,


j


,


p






p


r


o


d


u


c


t






≤


1




i


∈


I


,


j


∈


J










(27)




At least one stream for product 
p
 appears in the block superstructure.
The temperature range for block with product stream 
p
 is 




[




T


p




m


i


n








, 






T


p




m


a


x






]




.
Likewise, the pressure range for product block is 




[




P


p




m


i


n








, 






P


p




m


a


x






]




 as follows.
We impose the following constraint to tighten the bounds of block pressure 




P




i


,


j






 for blocks not involving product streams. This constraint states that if the block includes component 
k
, then the block pressure 




P




i


,


j






 is larger than the minimum product pressure 




P


p




m


i


n






.
Here, the set 




k


p


s


(


k


,


p


)




 specifies the type of component 
k
 in product 
p
.
Similarly, if the block includes component 
k
, then the block temperature 




T




i


,


j






 is correspondingly bounded above the minimum product temperature 




T


p




m


i


n






.
In WHENS problem, we assume mixing of different streams. Hence, we define the following binary variable to decide which component is allowed to exist in block 




B




i


,


j






.
The following constraints ensure that at most one component is allowed in block 




B




i


,


j






 and all other inlet component streams are prohibited from entering this block.
If the block 




B




i


,


j






 supplies product stream 
p
, the required component 
k
 should exists in this block. Similarly, if the block 




B




i


,


j






 takes feed stream 
f
, the feed components 
k
 are inside the same block.
Here the set 




k


f


s


(


k


,


f


)




 specifies all components 
k
 in feed 
f
.
The existence of component 
k
 in block 




B




i


,


j






 facilitate the tightening the bounds of block temperature 




T




i


,


j






.
Here 




T


k




m


a


x


k






 and 




T


k




m


i


n


k






 are maximum and minimum temperature in the system with 






T


k




m


a


x


k






=


max




(




max




f


∈


F


S








T


f




f


e


e


d






,




max




p


∈


p


S








T


p




m


a


x






)






 and 






T


k




m


i


n


k






=


min




(




min




f


∈


F


S








T


f




f


e


e


d






,




min




p


∈


P


S








T


p




m


i


n






)






The block boundaries are assigned as either unrestricted, semi-restricted or completely restricted boundary. If there is no pressure change across adjacent blocks through their connecting streams, then the inter-block boundary is unrestricted. If there is pressure change across a boundary, then the boundary is semi-restricted. If there is no mass allowed to flow between adjacent blocks, then the inter-block boundary is identified as completely restricted boundary.
Only one type of the boundaries is activated between two adjacent blocks.
Mass flow is prohibited while energy flow is allowed across a completely restricted boundary between adjacent blocks.
Each block has phase assignment according to the components existing in it, temperature, and pressure condition. We define binary variables for liquid phase and gas phase in block 




B




i


,


j






. This phase relations are adapted from the work of Nair et al. [
24
].
Besides the following 0–1 continuous variable is defined for the two-phase zone in block 




B




i


,


j






.
The enthalpy expression for liquid phase and gas phase is linearly dependent on the block temperature 




T




i


,


j






 and block pressure 




P




i


,


j






.
Here 




a


k


l




, 




b


k


l




, 




c


k


l




, 




a


k


v




, 




b


k


v




 and 




c


k


v




 are parameters used for determining the enthalpy of liquid and gas phase.
The enthalpy expression for two-phase region is approximated as the linear segment between enthalpy at bubble point 




T




i


,


j






B


P






 and that at dew point 




T




i


,


j






D


P






.
The bubble point and dew point for component 
k
 in block 




B




i


,


j






 are linearly dependent on the block pressure 




P




i


,


j






.
Here 




a


k


b




, 




b


k


b




, 




a


k


d




, and 




b


k


d




 are parameters for determining bubble point and dew point.
The general bubble point and dew point temperatures are then assigned to block bubble temperature 




T




i


,


j






B


P






 and block dew temperature 




T




i


,


j






D


P






, if component 
k
 exists in block 




B




i


,


j






.
The definition of 




z




i


,


j






l


v






 is achieved through the following constraint.
When 






z




i


,


j




l




=


0




 and 






z




i


,


j




v




=


0




, the above constraint is reduced to 






z




i


,


j






l


v






=




(




T




i


,


j






-




T




i


,


j






B


P






)




/




(




T




i


,


j






D


P






-




T




i


,


j






B


P






)






.
Block temperature 




T




i


,


j






 is related with 




z




i


,


j




l




 and 




z




i


,


j




v




 respectively through the following two constraints.
Similarly, the obtained enthalpy expressions 




H




i


,


j


,


k




l




, 




H




i


,


j


,


k




v




, and 




H




i


,


j


,


k






l


v






 map to the block enthalpy 




E




H




i


,


j


,


k








 via 




z




i


,


j




l




, 




z




i


,


j




v




, 




z




i


,


j






l


v






 and 




z




i


,


j


,


k






m


i


x






 through the following big-M constraints.
Here 




E




H




i


,


j


,


k






m


a


x








, 




d




H




D


P


T


,


k






m


a


x








, 




d




H




B


P


T


,


k






m


a


x








, 




H


k




m


i


n






 and 




H


k




m


a


x






 are appropriate big-M values.
Instead of following the conventional heat integration [
46
], we propose a heat transfer boundary model. The representation for model describes the heat transfer across a wall (completely restricted boundary). The block that supplies the energy flow is the heat source, while the block that takes the energy flow is the heat sink. Hence, there is no need to assign binary variable for determining the identity of process streams in each block since they are automatically determined by the heat transfer direction. Besides, no stage number for heat integration need to be specified in advance.
The total amount of heat duty 




E


F


t


o




t




i


,


j


,


d








 exchanged at boundary between block 




B




i


,


j






 and 




B




i


,


j


+


1






 in horizontal direction (or between block 




B




i


,


j






 and 




B




i


+


1


,


j






 in vertical direction) is determined as follows:








E


F


t


o




t




i


,


j


,


d






=


E


F




P




i


,


j


,


d






+


E


F




N




i


,


j


,


d








i


∈


I


,


j


∈


J


,


d


∈


D










(56)




The inlet temperature to block 




B




i


,


j






 is designated 




T




i


,


j






i


n






. The bound of 




T




i


,


j






i


n






 can be tightened to be 




[




T


k




m


i


n


k






,




T


k




m


a


x


k






]




 if component 
k
 exists in block 




B




i


,


j






. This is achieved through the following constraint:










T




i


,


j






-




(




T




m


a


x






-




T




m


i


n






)






(


1


-




z




i


,


j


,


k






m


i


x






)




≤




T




i


,


j






i


n






≤




T




i


,


j






+




(




T




m


a


x






-




T




m


i


n






)






(


1


-




z




i


,


j


,


k






m


i


x






)






i


∈


I


,


j


∈


J


,


k


∈


K










(57)




The inlet temperature to block 




B




i


,


j






, 




T




i


,


j






i


n






, is equal to the temperature of overall inlet streams after mixing effect. The 




T




i


,


j






i


n






 is obtained through the following energy balance at the inlet port of the block 




B




i


,


j






. Since compression or expansion operation also contribute to the temperature change at the inlet part of each block, 




W




i


,


j






c


o


m


p






 and 




W




i


,


j






e


x


p






 are included into the energy balance at the inlet port.
The inlet stream enthalpy terms on the right-hand side of the above equation is determined based on the inlet temperature of the destinate block 




T




i


,


j






i


n






, the pressure of the destinate block 




P




i


,


j






 (since 




W




i


,


j






c


o


m


p






 and 




W




i


,


j






e


x


p






 already contributes to the pressure change).















E


F




P




i


,


j


,


1






i


n














=




∑


k




F




P




i


,


j


,


k


,


1








{






H


k


l






(




T




i


,


j


+


1






i


n






,




P




i


,


j


+


1






)






z




i


,


j




l




+




H


k


v






(




T




i


,


j


+


1






i


n






,




P




i


,


j


+


1






)






z




i


,


j




v


















+




z




i


,


j






l


v








(


1


-




z




i


,


j




l




-




z




i


,


j




v




)






H


k




l


v








(




T




i


,


j


+


1






i


n






,




P




i


,


j


+


1






)






}




i


∈


I


,


j


∈


J


















(59)


















E


F




N




i


,


j


,


1






i


n














=




∑


k




F




N




i


,


j


,


k


,


1








{






H


k


l






(




T




i


,


j






i


n






,




P




i


,


j






)






z




i


,


j


+


1




l




+




H


k


v






(




T




i


,


j






i


n






,




P




i


,


j






)






z




i


,


j




v


















+




z




i


,


j


+


1






l


v








(


1


-




z




i


,


j


+


1




l




-




z




i


,


j


+


1




v




)






H


k




l


v








(




T




i


,


j






i


n






,




P




i


,


j






)






}




i


∈


I


,


j


∈


J


















(60)


















E


F




P




i


,


j


,


2






i


n














=




∑


k




F




P




i


,


j


,


k


,


2








{






H


k


l






(




T




i


+


1


,


j






i


n






,




P




i


+


1


,


j






)






z




i


,


j




l




+




H


k


v






(




T




i


+


1


,


j






i


n






,




P




i


+


1


,


j






)






z




i


,


j




v


















+




z




i


,


j






l


v








(


1


-




z




i


,


j




l




-




z




i


,


j




v




)






H


k




l


v








(




T




i


+


1


,


j






i


n






,




P




i


+


1


,


j






)






}




i


∈


I


,


j


∈


J


















(61)


















E


F




N




i


,


j


,


2






i


n














=




∑


k




F




N




i


,


j


,


k


,


2








{






H


k


l






(




T




i


+


1


,


j






i


n






,




P




i


+


1


,


j






)






z




i


+


1


,


j




l




+




H


k


v






(




T




i


,


j






i


n






,




P




i


,


j






)






z




i


+


1


,


j




v


















+




z




i


+


1


,


j






l


v








(


1


-




z




i


+


1


,


j




l




-




z




i


+


1


,


j




v




)






H


k




l


v








(




T




i


,


j






i


n






,




P




i


,


j






)






}




i


∈


I


,


j


∈


J


















(62)


















E




J




i


,


j


,




i


′




,




j


′








i


n














=




∑


k




J




F




i


,


j


,




i


′




,




j


′




,


k








{






H


k


l






(




T






i


′




,




j


′








i


n






,




P






i


′




,




j


′








)






z




i


,


j




l




+




H


k


v






(




T






i


′




,




j


′








i


n






,




P






i


′




,




j


′








)






z




i


,


j




v


















+




z




i


,


j






l


v








(


1


-




z




i


,


j




l




-




z




i


,


j




v




)






H


k




l


v








(




T






i


′




,




j


′








i


n






,




P






i


′




,




j


′








)






}




i


∈


I


,


j


∈


J


















(63)












E




M




i


,


j






i


n






=




∑




(


k


,


f


s


)


∈


k


f


s








M




i


,


j


,


k


,


f








{






H


k


l






(




T




i


,


j






i


n






,




P




i


,


j






)






(


1


-


z


p




h


k




f


e


e


d






)




+




H


k


v






(




T




i


,


j






i


n






,




P




i


,


j






)




z


p




h


k




f


e


e


d








i


∈


I


,


j


∈


J










(64)




The phase of the above streams, 




E


F




P




i


,


j


,


1






i


n








, 




E


F




N




i


,


j


,


1






i


n








, 




E


F




P




i


,


j


,


2






i


n








, 




E


F




N




i


,


j


,


2






i


n








, 




E




J




i


,


j


,




i


′




,




j


′








i


n








 and 




E




M




i


,


j






i


n








, are the same as the phase of block where these streams originate from. Parameter 




z


p




h


k




f


e


e


d








 describes the phase of feed streams, which is equal to one if feed enters the system as gas and equal to zero if the feed enters the system as liquid.
When the energy flow direction in horizontal direction is from block 




B




i


,


j






 to block 




B




i


,


j


+


1






 (






z




i


,


j


,


1






p


l


u


s






=


1




), the inlet and outlet approach temperatures for process streams in adjacent blocks separated by completely restricted boundary are determined as follows:








d


t


i




n




i


,


j


,


1






p


l


u


s






≤




T




i


,


j






i


n






-




T




i


,


j


+


1






+


d




t




u


p








(


2


-




z




i


,


j


,


1






p


l


u


s






-




z




i


,


j


,


1






c


r






)






i


∈


I


,


j


∈


J










(65)




Here when energy flow direction is in positive direction 






z




i


,


j


,


1






p


l


u


s






=


1




 and 






z




i


,


j


,


1






c


r






=


1




. The inlet approach temperature and outlet approach temperature are 




d


t


i




n




i


,


j


,


1






p


l


u


s






=


T


i




n




i


,


j






-




T




i


,


j


+


1








 and 




d


t


o


u




t




i


,


j


,


1






p


l


u


s






=




T




i


,


j






-




T




i


,


j


+


1






i


n








.
Similarly, the approach temperatures for process streams exchanging heat in vertical direction (




d


=


2




) are determined as follows:








d


t


i




n




i


,


j


,


2






p


l


u


s






≤




T




i


,


j






i


n






-




T




i


+


1


,


j






+


d




t




i


,


j


,


2






u


p








(


2


-




z




i


,


j


,


2






p


l


u


s






-




z




i


,


j


,


2






c


r






)






i


∈


I


,


j


∈


J










(67)




When the energy flow direction in horizontal direction is from block 




B




i


,


j


+


1






 to block 




B




i


,


j






, the inlet and outlet approach temperatures are obtained with the following two relations:








d


t


i




n




n


e


g








(


i


,


j


,


1


)




≤




T




i


,


j


+


1






i


n






-




T




i


,


j






+


d




t




i


,


j


,


1






u


p








(


1


+




z




i


,


j


,


1






p


l


u


s






-




z




i


,


j


,


1






c


r






)






i


∈


I


,


j


∈


J










(69)




Similarly, in vertical direction (




d


=


2




) with energy flow direction from block 




B




i


+


1


,


j






 to block 




B




i


,


j






, the inlet and outlet approach temperatures are obtained with the following two relations:








d


t


i




n




i


,


j


,


2






n


e


g






≤




T




i


+


1


,


j






i


n






-




T




i


,


j






+


d




t




u


p








(


1


+




z




i


,


j


,


2






p


l


u


s






-




z




i


,


j


,


2






c


r






)






i


∈


I


,


j


∈


J










(71)




Similarly, approach temperatures for blocks with hot utility and cold utility are given by:








d


t


i




n




i


,


j






C


U






≤




T




i


,


j






i


n






-


T


C


U


O


U


T


+


d




t




u


p








(


1


-




z




i


,


j






c


o


d






)






i


∈


I


,


j


∈


J










(73)




Parameters 




T


C


U


O


U


T




 and 




T


C


U


I


N




 are outlet and inlet temperature of cold utility while 




T


H


U


O


U


T




 and 




T


H


U


I


N




 are outlet and inlet temperature of hot utility.
Only one heat duty at heat transfer boundary and one approach temperature variable are required for determining the heat exchanger area. These are ensured through the following inequalities:








d


t


i




n




i


,


j


,


d






≤


d


t


i




n




i


,


j


,


d






p


l


u


s








d


t


i




n




i


,


j


,


d






≤


d


t


i




n




i


,


j


,


d






n


e


g








i


∈


I


,


j


∈


J


,


d


∈


D










(77)




With the approach temperature and heat duty of heat exchangers, we determine the heat exchange areas as follows:
















A




i


,


j


,


d






=


E


F


t


o




t




i


,


j


,


d






/




U




h


x










(


d


t


i




n




i


,


j


,


d






d


t


o


u




t




i


,


j


,


d








(


d


t


i




n




i


,


j


,


d






+


d


t


o


u




t




i


,


j


,


d






)




/


2


)






1


/


3










i


∈


I


,


j


∈


J


,


d


∈


D
















(79)




Here, 




A




i


,


j


,


d






, 




A




i


,


j






H


U






 and 




A




i


,


j






C


U






 represent heat exchange area between process streams, between process stream in block 




B




i


,


j






 and hot utility, between process stream in block 




B




i


,


j






 and cold utility respectively. We use Chen’s approximation to calculate the logarithmic mean temperature difference in area calculations. 




U




h


x






, 




U




H


U






, 




U




C


U






 are overall heat transfer coefficient at heat exchangers, heaters, and coolers.
A semi-restricted boundary can be assigned with either an expander, a compressor, or a valve. These assignments are indicated through the following binary variables:










z




i


,


j


,


d


,


m






s


r


e






=










1








If




turbine




on




SSTC




m




exists




on




right




or




bottom




boundary




(




d


=


1






or






d


=


2




)




of




block






B




i


,


j
















0






Otherwise




















Only one of these pieces of pressure-changing equipment is allowed on semi-restricted boundary.











z




i


,


j


,


d






s


r






=




∑


m






z




i


,


j


,


d


,


m






s


r


e






+




∑


m






z




i


,


j


,


d


,


m






s


r


c






+




z




i


,


j


,


d






s


r


v








i


∈


I


,


j


∈


J


,


d


∈


D










(82)





For the right or bottom boundary of block 




B




i


,


j






 (




d


=


1




 or 




d


=


2




), there can be a situation that 






z




i


,


j


,


d






s


r


v






=


1




 while the flow associated with the boundary 






F




i


,


j


,


k


,


d






=


0




. This does not indicate an existence of valve operation at the boundary but suggests that the temperature and pressure relation at the boundary is relaxed. This avoids the happening of infeasibility. Since 




z




i


,


j


,


d






s


r


v






 is also not related with the cost function, its value has no influence on the objective value.
The existence of shaft 
m
 is indicated through the following binary variable:










z


m




x


m






=










1








If




shaft




m




exists












0






Otherwise




















If an SSTC exists, there is at least one compressor or turbine. To avoid symmetric solution, we prefer shaft with lower index.
On each shaft, there exists a motor or a generator. These are represented with binary variables:










z


m




g


e


n






=










1








If




shaft




m




involves




a




motor












0






Otherwise




















If a shaft does not exist, then the motor and generator on this shaft also do not exist. If a generator or a motor exists on a shaft, then there is at least one semi-restricted boundary assigned with turbines or compressors on this shaft.
We define the positive variable 




P




R




i


,


j


,


d




F






 to designate the pressure ratio between the block 




B




i


,


j


+


1






 and 




B




i


,


j






 for flow alignment 




d


=


1




 or between the block 




B




i


+


1


,


j






 and 




B




i


,


j






 for flow alignment 




d


=


2




. The calculation of 




P




R




i


,


j


,


d




F






 is activated when the boundary of block 




B




i


,


j






 is semi-restricted or unrestricted at the corresponding flow alignment 
d
 (




z




i


,


j


,


d






s


r






 = 1 or 




z




i


,


j


,


d






u


r






 = 1). The pressure ratio is taken as 1 to avoid the calculation of the pressure ratio if this boundary is not semi-restricted. In horizontal direction, the pressure ratio is determined as follows:












P




i


,


j


+


1








P




i


,


j








-


P




R




u


p








(


1


-




z




i


,


j


,


1






s


r






)




≤


P




R




i


,


j


,


1




F




≤






P




i


,


j


+


1








P




i


,


j








+


P




R




u


p








(


1


-




z




i


,


j


,


1






s


r






)






i


∈


I


,


j


∈


J










(88)




Here, 




P




R




u


p








 is taken as the maximum pressure ratio, which is determined as 






P




m


a


x






/




P




m


i


n








. Similarly, in vertical direction, the pressure ratio is determined as follows:












P




i


+


1


,


j








P




i


,


j








-


P




R




u


p








(


1


-




z




i


,


j


,


2






s


r






)




≤


P




R




i


,


j


,


2




F




≤






P




i


+


1


,


j








P




i


,


j








+


P




R




u


p








(


1


-




z




i


,


j


,


2






s


r






)






i


∈


I


,


j


∈


J










(91)




For feed stream 
f
, the pressure ratio is taken as the ratio between block pressure 




P




i


,


j






 and parameter 




P


f




f


e


e


d






 for feed pressure .
The work term 




W




i


,


j






 consists of compression work term 




W




i


,


j






c


o


m






 and expansion work term 




W




i


,


j






e


x


p






. Both 




W




i


,


j






c


o


m






 and 




W




i


,


j






e


x


p






 consist of work components for direct connecting streams (




W




i


,


j


,


d






c


o


m


p


,


F


P






 for positive component, 




W




i


,


j


,


d






c


o


m


p


,


F


N






 for negative component), feed streams(




W




i


,


j


,


f






c


o


m


p


,


F


S






), and jump connecting streams (




W






i


′




,




j


′




,


i


,


j






c


o


m


p


,


J


f






). Accordingly,
From these pressure ratio definitions, we calculate the isentropic work on direct connecting streams, feed streams and jump connecting streams. In the horizontal direction, the inlet isentropic work is determined as follows:








η




W




i


,


j


,


1






c


o


m


p


,


F


P






-




W




i


,


j


,


1






e


x


p


,


F


P






/


η


=




∑




k


∈


K






F




P




i


,


j


-


1


,


k


,


1








T




i


,


j


-


1


,


1




s






R




g


a


s








γ




γ


-


1








{






(


P




R




i


,


j


-


1


,


1




F




)








γ


-


1




γ






-


1


}






i


∈


I


,


j


∈


J










(97)




Here 




R




g


a


s






 is the gas constant and 


γ


 is the adiabatic compression coefficient. 


η


 is the adiabatic compression efficiency. Similarly, the isentropic work for a vertical entering stream is calculated as follows:








η




W




i


,


j


,


2






c


o


m


p


,


F


P






-




W




i


,


j


,


2






e


x


p


,


F


P






/


η


=




∑




k


∈


K






F




P




i


-


1


,


j


,


k


,


2








T




i


-


1


,


j


,


2




s






R




g


a


s








γ




γ


-


1








{






(


P




R




i


-


1


,


j


,


2




F




)








γ


-


1




γ






-


1


}






i


∈


I


,


j


∈


J










(99)




The work terms related to feed streams and jump connecting streams are calculated in a similar way:








η




W




i


,


j


,


f






c


o


m


p


,


F


S






-




W




i


,


j


,


f






e


x


p


,


F


S






/


η


=




∑




k


∈


K








M




i


,


j


,


k


,


f








T


f




f


e


e


d








R




g


a


s








1




n




f


s










{






(


P




R




i


,


j


,


f






f


e


e


d






)






n




f


s








-


1


}






i


∈


I


,


j


∈


J


,


f


∈


F


S










(101)




Here 




n




f


s






 is the adiabatic compression coefficient.
These work components for direct connecting streams are related with the boundary type and the type of pressure exchangers assigned on semi-restricted boundary.
The compression work energy 




W




i


,


j






c


o


m


p






 and expansion energy 




W




i


,


j






e


x


p






 are determined as follows:














W




i


,


j






c


o


m


p












=




W




i


,


j


,


1






c


o


m


p


,


F


N






+




W




i


,


j


,


1






c


o


m


p


,


F


P






+




W




i


,


j


,


2






c


o


m


p


,


F


N






+




W




i


,


j


,


2






c


o


m


p


,


F


P






+




∑




f


s


∈


F


S








W




i


,


j


,


f


s






c


o


m


p


,


F


S




















+




∑






(




i


′




,




j


′




)




∈


L


N




(


i


,


j


,




i


′




,




j


′




)










W






i


′




,




j


′




,


i


,


j






c


o


m


p


,


J


f






,




i


∈


I


,


j


∈


J
















(111)


















W




i


,


j






e


x


p












=




W




i


,


j


,


1






e


x


p


,


F


N






+




W




i


,


j


,


1






e


x


p


,


F


P






+




W




i


,


j


,


2






e


x


p


,


F


N






+




W




i


,


j


,


2






e


x


p


,


F


P






+




∑




f


s


∈


F


S








W




i


,


j


,


f


s






e


x


p


,


F


S




















+




∑






(




i


′




,




j


′




)




∈


L


N




(


i


,


j


,




i


′




,




j


′




)










W






i


′




,




j


′




,


i


,


j






e


x


p


,


J


f






,




i


∈


I


,


j


∈


J
















(112)




The following shaft balance distributes the energy generated by turbines to compressors on the same shaft. Additional energy is transferred to motors to generate electricity. If the energy supply is not enough, electricity is consumed to activate motors.















w




H


m




+




∑




i


,


j








W




i


,


j


,


1






e


x


p


,


F


N








z




i


,


j


,


1


,


m






s


r


e






+




∑




i


,


j








W




i


,


j


,


1






e


x


p


,


F


P








z




i


,


j


-


1


,


1


,


m






s


r


e






+




∑




i


,


j








W




i


,


j


,


2






e


x


p


,


F


N








z




i


,


j


,


2


,


m






s


r


e






+




∑




i


,


j








W




i


,


j


,


2






e


x


p


,


F


P








z




i


-


1


,


j


,


1


,


m






s


r


e






=
















∑




i


,


j








W




i


,


j


,


1






c


o


m


p


,


F


N








z




i


,


j


,


1


,


m






s


r


c






+




∑




i


,


j








W




i


,


j


,


1






c


o


m


p


,


F


P








z




i


,


j


-


1


,


1


,


m






s


r


c






+




∑




i


,


j








W




i


,


j


,


2






c


o


m


p


,


F


N








z




i


,


j


,


2


,


m






s


r


c






+




∑




i


,


j








W




i


,


j


,


2






c


o


m


p


,


F


P








z




i


-


1


,


j


,


2


,


m






s


r


c






+


W




G


m


















(113)














z


m




m


o


t






w




H


L




≤


W




H


m




≤




z


m




m


o


t






w




H


U












(114)














z


m




g


e


n






w




G


L




≤


W




G


m




≤




z


m




g


e


n






w




G


U












(115)








w




H


U






 and 




w




G


U






 designate the maximum capacity of motors and generators, respectively. Please note that valves do not contribute to work energy. Hence, whenever the semi-restricted boundary is assigned with a valve, then that work energy term is ignored.
Additional constraints ensure that the block assigned with turbines or compressors should involve with gas phase.











∑


m






(




z




i


,


j


,


1


,


m






s


r


e






+




z




i


,


j


,


1


,


m






s


r


c






)




+




∑


m






(




z




i


,


j


,


2


,


m






s


r


e






+




z




i


,


j


,


2


,


m






s


r


c






)




≤




z




i


,


j




v












(116)




We consider an economic objective similar to Nair et al. [
24
] as follows:














min




T


A


C










=




γ


a




(




∑


m






α


m




g


e


n








(


C




F


m




g


e


n








z


m




g


e


n






+


C




P


m




g


e


n






W




G


m




β


m


G






)




+




∑


m






α


m




m


o


t








(


C




F


m




m


o


t








z


m




m


o


t






+


C




P


m




m


o


t






W




H


m




β


m


G






)


















+




∑




i


,


j


,


d








α


c






(


C




F


c






∑


m






z




i


,


j


,


d


,


m






s


r


c






+




∑


m




C




P


c






z




i


,


j


,


d


,


m






s


r


c










(




W




i


,


j


,


d






c


o


m


p


,


F


P






)






β


m


c






+




∑


m




C




P


c






z




i


,


j


,


d


,


m






s


r


c










(




W




i


,


j


,


d






c


o


m


p


,


F


N






)






β


m


c






)


















+




∑




i


,


j


,


d








α


e






(


C




F


e






∑


m






z




i


,


j


,


d


,


m






s


r


e






+




∑


m




C




P


e






z




i


,


j


,


d


,


m






s


r


e










(




W




i


,


j


,


d






e


x


p


,


F


P






)






β


m


e






+




∑


m




C




P


e






z




i


,


j


,


d


,


m






s


r


e










(




W




i


,


j


,


d






e


x


p


,


F


N






)






β


m


e






)


















+




∑




i


,


j


,


d








α




h


x








(


C




F




h


x








z




i


,


j


,


d






c


r






+


C




P




h


x








A




i


,


j


,


d






)




+




∑




i


,


j








α




h


o


t








(


C




F




h


o


t








z




i


,


j






h


o


t






+


C




P




h


o


t








A




i


,


j






H


U






)


















+




∑




i


,


j








α




c


o


d








(


C




F




c


o


d








z




i


,


j






c


o


d






+


C




P




c


o


d








A




i


,


j






C


U






)




)


+




∑




i


,


j








(


C




C




H


U








Q




i


,


j




h




+


C




C




C


U








Q




i


,


j




c




)


















+




∑


m






(


C




C


E




W




H


m




-


R


e




v


G




W




G


m




)


















(117)




Here 




γ


a




 is the annualized factor. This objective function aims at minimizing total annual cost (




T


A


C




). This 




T


A


C




 mainly involves capital costs including those of generator, motor, compressor, expander, and heat exchangers, as well as operating cost including costs of running motors, utility consumption. Besides, the electricity generated by generators bring revenue. The parameter 




C


F




 is the fixed cost for different equipment. 




C


P




 is the appropriate cost coefficient for associated equipment. 




C


C




 is the unit cost for utilities. 




R


e




v


G






 is the price of electricity while parameter 


α


 is the cost factor.
The above MINLP model is applied to a WHENS problem related to a liquefied energy chain reported by Nair et al. [
24
]. Liquefaction is an energy-intensive process that converts natural gas (NG) into liquid form for economic and safe transportation [
47
,
48
,
49
]. The overall procedure for solving the case study is illustrated in 
Figure 6
.
The stream information such as stream properties, temperature range, pressure range, and flowrate is directed to the block-based MINLP model for WHENS problem. This MINLP is solved using commercial solvers and results in block configurations. The block configurations are then converted to classic work and heat exchange networks. The procedure for this conversion can be found in Demirel et al. [
37
] and Li et al. [
38
] There are four process streams, including liquid inert nitrogen (




S


1




), liquefied natural gas or LNG (




S


2




), liquid carbon dioxide (




S


3




), and the propane pre-cooled mixed refrigerant (C3MR) (




S


4




) and one external stream as hot utility (HU). Among these process streams, part of 




S


1




 also serves as cold utility stream (CU). The information is provided in 
Table 2
.
Stream property information is provided in 
Table 3
 and include bubble point, dew point, enthalpy calculation for streams in liquid and gas phases. Since we assume these variables are linearly dependent on both system temperature and pressure, the following linear coefficients are sufficient to capture the thermodynamic relations. The unit for bubble point and dew point are K while the units for liquid enthalpy and gas enthalpy are kJ/kg.
The equipment considered are compressors, expanders, motors, generators, and heat exchangers. The cost coefficients for them are reported in the 
Table 4
. Please note that the additional amount of energy brought by generator can be converted into electricity, contributing to the revenue gaining.
We select a 




3


×


3




 block superstructure. To facilitate the solution, we reduce the number of binary variables by prohibiting the use of valves. The heat transfer boundaries are only allowed in the horizontal direction. To reduce the number of non-linear terms, we fix all jump connecting streams to be zero. This restricts the number of process alternatives but helps to demonstrate the capability of the proposed approach. This case study is solved using solver ANTIGONE 24.4.3 developed by Misener et al. [
50
] in GAMS 24.4 (2015 version and developed by GAMS Development Corporation in Fairfax, VA, USA) on a Dell OptiPlex 9020 computer (Intel 8 Core i7-4770 CPU 3.4 GHz, 15.5 GB memory) running Springdale Linux. We consider two different cases of this case study to show the capability of the proposed approach. Case 1 involves liquefaction of NG using available process streams. Case 2 achieves the liquefaction of NG using C3MR.
Solver SCIP (representing Solving Constraint Integer Programs) [
51
] is used for initializing the proposed model. This model is solved within 2 h with optimal total annual cost as 0.696 MM
$
/year with total capital cost of 0.225 MM
$
/year and operating cost of 0.471 MM
$
/year. The block configuration and the equivalent process flowsheet are shown in 
Figure 7
. Stream 




S


3




 flows into block 




B




3


,


1






 and is cooled using the HU. Stream 




S


3




 is distributed in block 




B




3


,


2






, block 




B




3


,


3






 and block 




B




2


,


3






 with feed fractions of 0.34, 0.18, and 0.32, respectively. A CU is supplied into block 




B




3


,


2






 to partially cool down the stream 




S


1




. The vertical outlet flow of block 




B




3


,


3






 is integrated with stream 




S


2




, where 




S


2




 serves as the hot stream and 




S


1




 in block 




B




2


,


3






 serves as the cold stream. Please note that the identity of these two streams were not postulated in advance. This was identified by the heat transfer direction reported in the solution. For instance, the energy flow at the right boundary of block 




B




2


,


2






 is from block 




B




2


,


2






 to block 




B




2


,


3






. Hence, the stream in block 




B




2


,


2






 is a hot stream while the stream in block 




B




2


,


3






 is a cold stream. The additional amount of heat transferred from block 




B




2


,


2






 is compensated by a CU in block 




B




2


,


3






. After heat integration, stream 




S


2




 is withdrawn in block 




B




2


,


2






 and stream 




S


1




 is withdrawn in block 




B




1


,


3






 after the expansion at the bottom boundary of block 




B




1


,


3






. The relevant block temperature and block pressure can be found in 
Figure 7
a.
The corresponding process flowsheet is shown in 
Figure 7
b. Streams 




S


1




 and 




S


2




 are integrated through heat exchanger HX2 with heat duty of 862.61 KW. Stream 




S


3




 is not involved in either heat integration or work integration. A heater with heat duty as 410.74 KW helps stream 




S


3




 to achieve the design target. The heat duty of coolers on stream 




S


1




 are 10.42 KW, 381.36 KW for cooler HX1 and HX3, respectively. Through this case study on liquefied energy chain, we show that the proposed approach could enable both heat and work integration opportunities. These integration alternatives reduced the energy consumption and total annual cost, resulting in significant energy intensification within the network structure. The identity of process streams was determined simultaneously together with network generation. Besides, compared with classic superstructure representation approach, no information on work and heat exchange stage number was required.
Next, we consider a conceptual design problem where the goal is to obtain a liquefaction process for a NG stream from an initial gaseous condition of 1 atm and 298.15 K to a final condition of saturated LNG at 1 atm (which corresponds to a final temperature below 113.15 K). Interestingly, this process synthesis problem can be formulated as a WHENS problem, where we have two process streams, namely the NG (hot stream) and C3MR. The refrigerant can be considered as a neutral stream or a circulating working fluid with the same initial and final conditions. Any feasible process configuration for this design problem would involve heat exchangers, and the temperatures indicate that cryogenic cooling is necessary. However, consider that cooling water at the ambient temperature is the only CU that is available for the process. To this end, work exchangers (compressors and expanders) would be required. The refrigerant would undergo a cycle involving multiple alternating heat and work exchangers to first achieve a cryogenic temperature through expansion at which heat can be gained from the NG stream, and then achieve a high temperature through compression at which heat can be released to the cooling water. This is what happens in a typical refrigeration cycle.
While such an answer is well-known for this problem, this is to illustrate the possibility of discovering non-intuitive process flowsheets involving heat and work exchangers using the building block approach. Consider a naive designer who does not have any prior knowledge of how a refrigeration cycle works, or how a stream should be liquefied at cryogenic conditions when cooling utilities are only available at the ambient condition. The designer can still obtain the same solution, as it is already embedded in the general block-based WHENS superstructure (see 
Figure 8
).
The NG stream enters the process as a gaseous stream in block 




B




1


,


1






 and finally exits as a saturated liquid from block 




B




1


,


3






. Before exiting, NG exchanges heat with the refrigerant C3MR through the bottom boundary of block 




B




1


,


2






. C3MR cycles through the blocks placed in rows 2 and 3. Starting from block 




B




3


,


2






, the refrigerant C3MR enters as a vapor stream and is cooled into a two-phase mixture in a utility cooler using cooling water as the CU. The outlet stream from block 




B




3


,


3






 is expanded which results in a liquid C3MR with a reduced temperature when entering the block 




B




2


,


3






 through a valve placed at the top semi-restricted boundary of block 




B




3


,


3






. The horizontal outlet stream of block 




B




2


,


2






 is vaporized using the heat released by NG through the completely restricted boundary between the blocks 




B




1


,


2






 and 




B




2


,


2






. The C3MR vapor after the heat exchanger is compressed across a semi-restricted boundary assigned on the bottom of block 




B




2


,


1






 before it is finally withdrawn in block 




B




3


,


2






. The seamless entrance and exit of C3MR within the same block 




B




3


,


2






 suggests the existence of a cycle. The corresponding process flowsheet is shown in 
Figure 8
b.
We presented a method to automatically generate numerous alternative configurations for the synthesis of integrated work and heat exchange networks using building blocks. The block representation is abstract, and it requires a transformation to obtain classic unit operations and flowsheet configurations. However, it is also analogous in a sense that the transformations from blocks-to-flowsheets and from flowsheets-to-blocks are systematic. The benefits of block-based representation over a unit operations-based representation is that the former uses only two fundamental design elements, namely the block interior and the block boundary. Alternative arrangement of flows to block interior and assignment of work/heat transfer phenomena to block boundaries give rise to alternative networks for systematic WHENS. The heat and work transfer models are general such that they do not depend on the postulation of stream identities. Besides, there is no need to specify any stagewise integration. With this representation approach, we formulated an MINLP model for WHENS. Using a case study, we demonstrated the capability of the block-based approach for WHENS. We also considered the possibility of discovering non-intuitive process flowsheets involving heat and work exchangers. Specifically, the case of NG liquefaction indicated that a designer could generate the design of a refrigeration cycle using the building block approach, even when designers have no prior knowledge of how a refrigeration cycle works, or how a stream should be liquefied at cryogenic conditions when cooling utilities are only available at ambient conditions. This provides hints towards the potential of our approach for the discovery of novel processes through process synthesis. However, further research is needed to extend the simultaneous process synthesis along with work and heat integration to more complex scenarios.
J.L., S.E.D., and M.M.F.H. conceived the ideas, models and prepared the manuscript.
The authors gratefully acknowledge financial support from the U.S. National Science Foundation (NSF CBET-1606027) and the DOE/RAPID NNMI Institute.
The authors declare no conflict of interest.