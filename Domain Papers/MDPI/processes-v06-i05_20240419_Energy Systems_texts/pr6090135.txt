To reduce CO






2




 emissions from power plants, electricity companies have diversified their generation sources. Fossil fuels, however, still remain an integral energy generation source as they are more reliable compared to the renewable energy sources. This diversification as well as changing electricity demand could hinder effective economical operation of an amine-based post-combustion CO






2




 capture (PCC) plant attached to the power plant to reduce CO






2




 emissions. This is as a result of large fluctuations in the flue gas flow rate and unavailability of steam from the power plant. To tackle this problem, efficient control algorithms are necessary. In this work, tracking and economic model predictive controllers are applied to a PCC plant and their economic performance is compared under different scenarios. The results show that economic model predictive control has a potential to improve the economic performance and energy efficiency of the amine-based PCC process up to 6% and 7%, respectively, over conventional model predictive control.
The reliance on fossil fuels, especially coal for electricity, is one of the major causes of increased amount of anthropogenic carbon dioxide in the atmosphere and climate change. At the moment, almost 40% of the world’s energy is produced from combustion of coal [
1
]. Although renewable energies such as those obtained from wind or solar or biomass can be helpful in reducing CO






2




 emissions, they are not mature enough to fully take over. Therefore, for these fossil fuels to keep contributing to the global energy mix, carbon capture and storage (CCS) must be implemented. CCS involves capturing carbon dioxide from large point sources such as power plants, transporting and storing it in deep geological or oceanic wells for a long time in a supercritical state [
2
]. Among the various options for CO






2




 capture, post-combustion CO






2




 capture (PCC) using reactive solvents is considered the most mature and viable option as it can easily be retrofitted to existing power plants. However, a major setback to the realization of this technology is its high regeneration heat requirement. Studies have shown that a PCC plant attached to a power plant reduces the power plant’s efficiency from about 40% to 30% [
3
].
Figure 1
 shows an overview of a fossil-fueled power plant with CO






2




 capture. In a typical fossil-fueled power plant with CO






2




 capture, the fuel is combusted in air to generate flue gas, which is used to generate high pressure steam in the steam generator. The steam is then used to turn a turbine leading to electricity generation. At the same time, part of the steam is sent to the PCC plant for regeneration of the captured CO






2




. This results in a reduction of the power plant’s efficiency. The flue gas (containing about 15 mol % CO






2




) on the other hand is channeled to the PCC plant for treatment before it is released into the atmosphere. The power plant’s ability to meet the varying demands of the end users while capturing CO






2




 is a major concern. This could result in large fluctuations in the flue gas flow rate and the availability of the steam from the power plant to the the capture plant. These fluctuations as well as issues such as complex/nonlinear system dynamics could make attainment of the operational objectives and control of the PCC plant difficult. These challenges have motivated the research on the development of more flexible and economical control for PCC plants.
Ziaii et al. [
4
] designed a ratio controller to maintain a 90% CO






2




 capture efficiency in the absorber. They considered a disturbance in the steam availability to the reboiler and used the liquid to gas flow ratio as the manipulated variable. Lin et al. [
5
] presented two different PI control strategies to maintain a desired absorption efficiency. They used the lean solvent flow rate and the reboiler heat input as the manipulated variables.
Advanced control algorithms such as Model Predictive Control (MPC) have also been applied to the control of PCC plants. Bedelbayev et al. [
6
] presented an MPC scheme for the absorber in standalone. Panahi and Skogestad [
7
,
8
] implemented an MPC scheme with two controlled variables—the CO






2




 recovery and the reboiler temperature. In the context of scheduling and control, He et al. [
9
] studied the flexibility of a post-combustion CO






2




 capture process using MPC. They conducted this study by investigating key process variables such as CO






2




 absorption efficiency and CO






2




 composition in the product stream in both closed-loop and open-loop. They observed that, under high frequency disturbances in the flue gas flow rate, a well-tuned controller is needed to avoid oscillations in the absorption efficiency. Bankole et al. [
10
] used a two-level control strategy consisting of an upper-level scheduler and a lower-level supervisory controller to handle the flexible operation of a load-following power plant with CO






2




 capture under three different capture scenarios. MacDowell and Shah [
11
] also evaluated the operation of a PCC plant under four different scenarios—load following, solvent storage, exhaust gas by-pass and time-varying solvent regeneration—using multi-period optimization.
An emerging MPC formulation that has a potential to determine the optimal operating policy directly in the control layer is Economic Model Predictive Control (EMPC). In EMPC, real-time process optimization and feedback control are unified [
12
]. This means that, in EMPC, an economic cost function or objective is directly optimized instead of tracking a predetermined set-point [
13
,
14
]. To date, EMPC has had some successful applications in different processes [
15
,
16
,
17
,
18
,
19
]. In the studies of Zeng et al. [
15
] and Liu et al. [
16
], for example, EMPC was applied to improve the effluent quality of a waste water treatment process and the operation of an oil sands primary separation vessel, respectively. Idris et al. [
17
] applied EMPC to a continuous catalytic distillation process whileMendoza-Serrano et al. [
18
] and Touretzky et al. [
19
] applied EMPC to temperature control in buildings. In these applications, EMPC showed a potential to significantly improve the performance of the classical MPC. However, it should be pointed out that the reported EMPC designs and their benefits are usually process specific. The general case where EMPC has a clear edge over classical MPC remains to be understood.
In this study, EMPC was applied to a PCC plant attached to a load-following power plant and its performance was compared with classical tracking MPC from different aspects. In particular, the operation of the PCC plant under time-varying flue gas flow rate and steam price was considered. The performance of tracking MPC and EMPC under two different carbon tax policies are investigated namely: without tax-free emission limit and with tax-free emission limit. The rest of the paper is organized as follows: in 
Section 2
, a detailed PCC plant model based on first principles is presented. In 
Section 3
, the designs of both MPC and EMPC as well as their numerical implementation are presented. In 
Section 4
, a systematic investigation of the performance of both MPC and EMPC from different aspects including time-varying conditions and uncertainty is conducted.
A typical PCC plant is comprised of two major operating units namely, absorption and desorption columns, where reactive separation takes place. A schematic diagram of the PCC plant considered in this work is shown in 
Figure 2
. The process starts in the absorption column where the flue gas (containing high amount of CO






2




) from the power plant is contacted with the lean solvent—solvent containing low amount of CO






2




 (in this work, state-of-the-art 5 M Monoethanolamine (MEA) is used as solvent)—in a counterclockwise way. The flue gas leaves the absorption column as treated gas with a low amount of CO






2




. The solvent with a high amount of CO






2




 (rich solvent) exits the absorption column and goes through the lean-rich heat exchanger where it trades heat with the lean solvent exiting the reboiler. The rich solvent enters the desorption unit and contacts hot vapor from the reboiler. In the desorption column, the acid gas (CO






2




) is stripped from the rich solvent. Gas with a high concentration of CO






2




 (90–99%) exits the desorption column from the top while the solvent moves out of the desorption column to the reboiler. In the reboiler, the solvent is heated to a temperature of about 120 C. The gas exits the reboiler to the desorption column while the lean solvent is recycled to the absorption column for re-absorption. In this work, the lean solvent flow rate and the steam from the power plant are the manipulated variables. The control objective is to reduce CO






2




 emissions and heat consumption at a reasonable economic cost. The disturbances are the flue gas flow rate and steam from the power plant.
Several studies on dynamic modelling of the PCC process exist in literature. The model used in this work is based on the work of Harun et al. [
20
]. However, the lean-rich heat exchanger was modeled using the log-mean temperature approach. In addition, the buffer tank and column heat losses were not considered in this work. The details of the model used in this study are summarized in this section.
The model formulations for the absorption and desorption units are similar. The differences are the direction of reactions and the presence of reboiler and condenser in the desorption unit.
The assumptions used in the modeling of the PCC plant are:
Well mixed bulk and liquid phases. Each stage therefore behaves like a continuously stirred tank reactor (CSTR) with no spacial variation in properties.
Reactions occur only in the liquid film and the influence of the reaction on mass transfer is described using enhancement factor.
Mass and heat transfer are described by the two film theory [
21
].
Pressure drop in the two columns is linear.
No heat losses to the surrounding area.
Well mixed bulk and liquid phases. Each stage therefore behaves like a continuously stirred tank reactor (CSTR) with no spacial variation in properties.
Reactions occur only in the liquid film and the influence of the reaction on mass transfer is described using enhancement factor.
Mass and heat transfer are described by the two film theory [
21
].
Pressure drop in the two columns is linear.
No heat losses to the surrounding area.
Equations (
1
)–(
4
) describe the mass and heat balances occurring in the two columns. These equations are written along the axis of the columns to determine the axial concentration and temperature profiles. Since the assumption that a stage in both columns is well mixed has been made, there are no radial changes in temperature and concentration in each column: 












d




C




L


i










d


t






=






4




F


L








π




D


c


2












∂




C




L


i










∂


l






+




(




N


i






a


I




)




,




i


=




CO


2




,


MEA


,




H


2




O


,




N


2




,










(1)
















d




C




G


i










d


t






=


−






4




F


G








π




D


c


2












∂




C




G


i










∂


l






−




(




N


i






a


I




)




,




i


=




CO


2




,


MEA


,




H


2




O


,




N


2




,










(2)
















d




T


L








d


t






=






4




F


L








π




D


c


2












∂




T


L








∂


l






+






(




Q


L






a


I




)








∑




i


=


1




n






C




L


i








C




p


,


i










,










(3)
















d




T


G








d


t






=


−






4




F


G








π




D


c


2












∂




T


G








∂


l






+






(




Q


G






a


I




)








∑




i


=


1




n






C




G


i








C




p


,


i










.










(4)




In Equations (
1
)–(
4
) above, 




C


i




 is the phase (subscripts 
L
 and 
G
 are liquid phase and gas phase respectively) concentration of component 
i
 in 




kmol


/




m


3






, 
F
 is the phase volumetric flow in 






m


3




/


s




, 




D


c




 is the cross-sectional area of the column in 


m


, 




N


i




 is the mass transfer rate in 




kmol


/




m


2




s




, 
T
 is temperature in 


K


, 
l
 is the length of the column in 


m


, 




C


p




 is the heat capacity in 




kJ


/


kmol




, 
Q
 is the heat transfer rate in 




kJ


/




m


2




s




 and 




a


I




 is the interfacial area in 






m


2




/




m


3






. In the absorption unit, 




F


L




 is a manipulated variable to control the 




CO


2




 emission, whereas 




F


G




 is a disturbance from the power plant.
The mass transfer rates in the columns are determined using Equation (
5
):










N


i




=




K




G


i








P


t






(




y


i




−




y


i


∗




)




,






i


=




CO


2




,


MEA


,




H


2




O


,










(5)





where 




K




G


i






 is the overall mass transfer coefficient in 




kmol


/




m


3




Pa




, 




P


t




 is the stage pressure in 


Pa


, and 




y


i




 and 




y


i


∗




 are the bulk and equilibrium gas phase component mole fractions. The overall gas phase mass transfer coefficients are used to compute the mass transfer rates between the two phases. This is convenient as it avoids the determination of interfacial concentrations. In this work, the mass transfer rate of 




N


2




 is assumed to be zero or negligible.
The interface equilibrium H






2




O and MEA concentrations are determined from their saturated vapor pressures as shown in Equation (
6
), whereas that of CO






2




 is determined using Henry’s law as shown in Equation (
7
):










y


i


∗






P


t




=




x


i






γ


i






P


i


v




,






i


=




H


2




O


,


MEA


,










(6)














y


i


∗






P


t




=


H




e


i






C


i


∗






γ


i




,






i


=




CO


2




,










(7)





where 




γ


i




 is the activity coefficient of component 
i
, 




H




e


i






 is the Henry’s constant and 




P


i


v




 is the saturated vapor pressure of component 
i
 in 


Pa


.
The overall mass transfer coefficients are determined using Equation (
8
) below: 










1




K




G


i








=




1




k




G


i








+






H


e








k




L


i








E


f








,






i


=




CO


2




,


MEA


,




H


2




O


,










(8)





where 




k




G


i






 and 




k




G


i






 are the gas and liquid mass transfer coefficients of component 
i
, respectively, in 




kmol


/




m


2




s




 and 




E


f




 is the enhancement factor.
The mass transfer coefficients and interfacial area are estimated using Onda’s correlations [
22
]. The enhancement factor approach is used to determine the influence of the reactions on the rates of mass transfer. The pseudo-first order enhancement factor during absorption is calculated using Equation (
9
) determined by van Kravelen and Hoftijzer [
23
]: 








E


=










k


i






D


i






C


j












k


L




i






,






i


=




CO


2




,


j


=


MEA


,










(9)





where 




k


i




 is the second order rate constant in 






m


3




/


kmol




 and 




D


i




 is the liquid phase diffusivity of component 
i
 in 






m


2




/


s




. In the case of desorption, the enhancement factor is calculated using Equation (
10
) [
24
]: 








E


=


1


+








(






D




M


E


A


C


O




O


−










D




C




O


2










)










K




e


q








C




M


E


A




B














(


1


+


2




(






D




M


E


A


C


O




O


−










D




M


E


A








)










K




e


q








C




C




O


2






B








)






(






C




C




O


2






B






+






C




C




O


2






I






)








,










(10)





where 




D




M


E


A


C


O




O


−








, 




D




C




O


2








 and 




D




M


E


A






 are the liquid phase diffusivities of carbamate ion, CO






2




 and MEA respectively in 






m


2




/


s




, 




C




C




O


2






B




 and 




C




M


E


A




B




 are the bulk liquid phase concentrations of CO






2




 and MEA respectively in 




kmol


/




m


3






, 




C




C




O


2






I




 is the concentration of CO






2




 at the gas–liquid interface in 




kmol


/




m


3






, and 




K




e


q






 is the overall equilibrium rate constant in 






m


3




/


kmol




.
The heat transfer rates across the interface for gas and liquid phases are determined using Equations (
11
) and (
12
), respectively. The heat of reaction is accounted for in the liquid heat transfer rate computation:










Q


G




=




h




G


L








(




T


L




−




T


G




)




,










(11)














Q


L




=




h




G


L








(




T


L




−




T


G




)




+


Δ




H




r


x


n








N




C




O


2








+


Δ




H




v


a


p








N






H


2




O






,










(12)





where 




h




G


L






 is the gas–liquid heat transfer coefficient in 




kJ


/




m


2




s




, 




Δ




H




r


x


n








 is the heat of reaction between MEA and CO






2




 in 




kJ


/




m


3




s




 and 




Δ




H




v


a


p








 is the heat of vaporization of H






2




O in 




kJ


/




m


3




s




. The gas–liquid heat transfer coefficient was determined using the Chilton–Colburn analogy [
25
].
The heat exchanger, especially the lean-rich heat exchanger, is a crucial component of the post combustion capture plant. It seeks to make the process heat efficient by taking heat from the hot lean solvent (source) to the cool rich solvent (sink) exiting the absorber. Since there is no movement of mass from one stream to the other and no accumulation is assumed, the mass balances are not considered in the heat exchanger model.
The energy balance equations are shown in Equations (
13
) and (
14
):












d




T




t


u


b


e










d


t






=








V


˙






t


u


b


e








V




t


u


b


e










(




T




t


u


b


e


,


i


n






−




T




t


u


b


e


,


o


u


t






)




+




Q


˙






1










C


p




^






t


u


b


e








ρ




t


u


b


e








V




t


u


b


e










,










(13)
















d




T




s


h


e


l


l










d


t






=








V


˙






s


h


e


l


l








V




s


h


e


l


l










(




T




s


h


e


l


l


,


i


n






−




T




s


h


e


l


l


,


o


u


t






)




+




Q


˙






1










C


p




^






s


h


e


l


l








ρ




s


h


e


l


l








V




s


h


e


l


l










,










(14)





where 
T
 is the temperature in 


K


, 




V


˙




 is the volumetric flow rate in 






m


3




/


s




, 
V
 is the volume in 




m


3




, 




Q


˙




 is the heat transfer rate in 




kJ


/


s




, 






C


p




^




 is the average molar liquid heat capacity in 




kJ


/


kmol




, 


ρ


 is the average molar density in 




kmol


/




m


3






 and 




Δ




T




L


M


T


D








 is the log-mean temperature difference between the hot side and the cold side of the heat exchanger in 


K


. Subscripts 




t


u


b


e




, 




s


h


e


l


l




, 




i


n




 and 




o


u


t




 represent the tube-side, shell-side, inlets and outlets of the heat exchanger, respectively.
The log-mean temperature difference between the shell-side and tube-side was determined using Equation (
15
) below:










Q


˙




=


U


A


Δ




T




L


M


T


D






,










(15)












Δ




T




L


M


T


D






=






Δ




T


1




−


Δ




T


2








l


n


(


Δ




T


1




/


Δ




T


2




)






,










(16)





where 




Δ




T


1






 and 




Δ




T


2






 are equal to (






T




s


h


e


l


l


,


i


n






−




T




t


u


b


e


,


o


u


t








) and (






T




s


h


e


l


l


,


o


u


t






−




T




t


u


b


e


,


i


n








), respectively.
The reboiler is the most heat-intensive part of the plant. In this unit, the rich solvent is heated to break the chemical bonds between CO






2




 and MEA. H






2




O, CO






2




 and MEA are vaporized in the process and channeled to the bottom of the desorption unit. The solvent containing low amount of the acid gas (CO






2




) exits the unit as lean solvent.
The material balance around the reboiler is shown in Equation (
17
):












d




M


i








d


t






=




F




i


n








x




i


,


i


n






−


V




y




i


,


o


u


t






−


L




x




i


,


o


u


t






,




i


=




CO


2




,




MEAH


2




O


,










(17)





where 




M


i




 is the mass holdup of component 
i
 in 


kmol


, 
F
 is the molar flow rate in 




kmol


/


s




, 
V
 and 
L
 are the vapor and liquid flow rates, respectively, in 




kmol


/


s




. The subscripts 




i


n




 and 




o


u


t




 denote inlet and outlet streams, respectively. In this study, we assumed that the liquid level and the reboiler pressure does not change. Thus, there is no vapour or liquid holdup.
The energy balance equation is shown in Equation (
18
):








ρ




C


p




V






d




T




r


e


b










d


t






=




F




i


n








x




i


n






−


V




H




v


,


o


u


t






−


L




H




L


,


o


u


t






+




Q




r


e


b






,










(18)





where 




T




r


e


b






 is the temperature in 


K


, 


ρ


 is the density in 




kmol


/




m


3






, 




C


p




 is the molar heat capacity in 




kJ


/


kmol




, 
V
 is the holdup volume in 




m


3




, 
H
 is the enthalpy in 


kJ


 and 




Q




r


e


b






 is the heat input in 




KJ


/


s




. 




Q




r


e


b






 is used as a manipulated variable to control the reboiler temperature.
The accuracy of process models hinges on accurate predictions of the physical and chemical properties of the system. The non-ideal liquid phase behaviour of the CO






2




-MEA-H






2




O system was modeled using the electrolyte Non-Random Two Liquids (eNRTL) thermodynamic model. The liquid phase activity coefficients were obtained from Aspen Properties (version 9.0, Aspen Technology, Inc., Bedford, Massachusetts 01730, USA) and implemented via look-up tables. The gas phase behaviour was modeled as an ideal phase. The heat and mass transfer coefficients of the two phases are dependent on several property calculations such as diffusivity, viscosity, specific heat capacity, density and several other correlations. These correlations as well as the kinetic parameters for the CO






2




-MEA-H






2




O system used in this work can be found in the work of Harun [
26
].
The partial differential equations in the column equations are converted to ordinary differential equations using the method of lines. This results in the conversion of the derivatives with respect to the length of the column being discretized into five stages, thus rendering the partial differential equations as ordinary differential equations. After discretization, the model described in this section can be written in a compact form as shown in the system of Differential Algebraic Equations (DAEs) below:
















x


˙




=


f




(


x


,


z


,


u


,


p


)




,
















(19)


















g


(


x


,


z


,


u


,


p


)


=


0


,
















(20)


















y


=


h


(


x


,


z


,


u


,


p


)


,
















(21)





where 




x


∈




R


103






 denotes the differential states, 




z


∈




R


7






 denotes the algebraic states, 




u


=


[




F


L




,




Q




r


e


b






]




 denotes the manipulated input solvent flow rate in 




L


/


s




 and reboiler heat input in 


MW


, 




p


=


[




F


G




]




 denotes the uncontrolled input flue gas flow rate, 




y


=


[




y




C




O


2








,




T




r


e


b






]




 denotes the outputs CO






2




 flow rate in the treated gas in 




kg


/


h




 and reboiler temperature in 


K


. The system of DAEs described in Equations (
19
) – (
21
) will be used in the MPC and EMPC designs.
In this work, two control objectives are considered. The first is reduction of the amount of CO






2




 released into the atmosphere. The second control objective is the minimization of the heat consumed at the regeneration section of the plant. In the case of MPC, these objectives have been translated to tracking the optimal CO






2




 emission and reboiler temperature. Hard constraints are imposed to ensure that the temperature of the solvent in the reboiler does not go beyond the point where the solvent degrades (120 C). The designed controller must achieve these two control objectives while rejecting disturbances in the form of fluctuations in the flue gas flow rate originating from the power plant and time-varying steam price due to the time-varying electricity demand.
To operate chemical plants in a time-varying manner, process economic optimization and control are usually decomposed into a hierarchical structure or layer. In this work, the conventional set-point tracking MPC takes a two-step approach, namely: steady-state optimization (SSO) and dynamic tracking. First, a steady-state optimization is performed to determine the optimal operating point for MPC. The optimization problem is as follows:
Optimization problem 1.
 Steady-state optimization problem















min






x


s




,




z


s




,




u


s




,


ϵ














l


=




α


1






u




2


,


s






+




α


2




ϵ


,
















(22)


















s


.


t


.














f


(




x


s




,




z


s




,




u


s




,


p


)


=


0


,
















(23)


























g


(




x


s




,




z


s




,




u


s




,


p


)


=


0


,
















(24)




























y


s




=


h




(




x


s




,




z


s




,




u


s




,


p


)




,
















(25)




























y




1


,


s






−




y




l


i


m


i


t






≤


ϵ


,
















(26)


























ϵ


≥


0


,
















(27)


























385.15


≤




y




2


,


s






≤


393.15


,
















(28)


























0.1


≤




u




1


,


s






≤


2.0


,
















(29)


























0.05


≤




u




2


,


s






≤


0.5


,
















(30)





where 




y




l


i


m


i


t






 is the threshold value of CO






2




 above which cost will be incurred in kg/h, 


ϵ


 is a variable which represents the amount of CO






2




 released above the threshold value in kg/h, and 




α


1




 indicates the price of steam from the power plant, whereas 




α


2




 is the carbon price/tax.
Equation (
22
) is the economic cost function, Equations (
23
)–(
25
) are the steady-state of Equations (
19
)–(
21
) described in 
Section 2
 in compact form, and Equations (
26
) and (
27
) form a soft constraint on the CO






2




 emissions. Equations (
28
)–(
30
) are hard constraints on the reboiler temperature, solvent flow rate and reboiler heat input, respectively. The constraint on the reboiler temperature is to ensure that the temperature does not fall below the minimum CO






2




 regeneration temperature or go beyond the degradation temperature of the solvent.
MPC is an optimal control strategy that has gained popularity in the chemical process industry. The MPC controller is designed to track a predetermined optimal steady-state value. The cost function is quadratic and penalizes the deviations of the state and input trajectories from the set-point. The MPC used in this work takes the form shown below:
Optimization problem 2.
 Tracking MPC optimization problem















min




u


(


t


)


∈


S


(


Δ


)
















∫






t


k








t




k


+




N


p












(






(




y


s




−




y


˜






(


t


)




)




T




Q




(




y


s




−




y


˜






(


t


)




)




+






(




u


s




−


u




(


t


)




)




T




R




(




u


s




−


u




(


t


)




)




)




d


t


,
















(31)


















s


.


t


.


















x


˜




˙




=


f




(




x


˜






(


t


)




,




z


˜






(


t


)




,


u




(


t


)




,


p




(


t


)




)




,
















(32)


























g


(




x


˜






(


t


)




,




z


˜






(


t


)




,


u




(


t


)




,


p




(


t


)




)


=


0


,
















(33)




























y


˜




=


h




(




x


˜






(


t


)




,




z


˜






(


t


)




,


u




(


t


)




,


p




(


t


)




)




,
















(34)




























x


˜






(




t


k




)




=


x




(




t


k




)




,
















(35)


























385.15


≤






y


˜




2






(


t


)




≤


393.15


,
















(36)


























0.1


≤




u


1






(


t


)




≤


2.0


,
















(37)


























0.05


≤




u


2






(


t


)




≤


0.5


,
















(38)





where 




S


(


Δ


)




 is the family of piece-wise constant functions with a sampling time 


Δ


, 




N


p




 is the prediction horizon, 




x


˜




, 




y


˜




 and 




z


˜




 denote the predicted differential, output and algebraic states, respectively. 
Q
 and 
R
 are the weighting matrices on the outputs and control actions, respectively. Their determination and values are described in the results section.
In Optimization problem 2, Equation (
31
) is the cost function; Equations (
32
)–(
34
) represent the PCC model; Equation (
35
) is the initial condition of the system at time instant 




t


k




; and Equations (
36
)–(
38
) are the same as the constraints in Optimization problem 1. At the next sampling time, Optimization problem 2 is solved again. This forms an implicit feedback control law.
EMPC integrates steady-state optimization and dynamic tracking by directly optimizing economic performance in the dynamic control problem. The difference between MPC and EMPC is the cost function. While MPC uses a quadratic cost function and require set-point updating, EMPC uses a general economic cost function and does not require any set-points.
The EMPC at time instant 




t


k




 is formulated as the optimization problem below:
Optimization problem 3.
 EMPC optimization problem















min




u


(


t


)


∈


S


(


Δ


)
















∫






t


k








t




k


+




N


p












(




α


1






(


t


)






u


2






(


t


)




+




α


2




ϵ




(


t


)




)




d


t


,
















(39)


















s


.


t


.


















x


˜




˙




=


f




(




x


˜






(


t


)




,




z


˜






(


t


)




,


u




(


t


)




,


p




(


t


)




)




,
















(40)


























g


(




x


˜






(


t


)




,




z


˜






(


t


)




,


u




(


t


)




,


p




(


t


)




)


=


0


,
















(41)




























y


˜




=


h




(




x


˜






(


t


)




,




z


˜






(


t


)




,


u




(


t


)




,


p




(


t


)




)




,
















(42)




























x


˜






(




t


k




)




=


x




(




t


k




)




,
















(43)






























y


˜




1






(


t


)




−




y




l


i


m


i


t






≤


ϵ




(


t


)




,
















(44)


























ϵ


(


t


)


≥


0


,
















(45)


























385.15


≤






y


˜




2






(


t


)




≤


393.15


,
















(46)


























0.1


≤




u


1






(


t


)




≤


2.0


,
















(47)


























0.05


≤




u


2






(


t


)




≤


0.5


.
















(48)




In Optimization problem 3 above, Equation (
39
) is the cost function that minimizes the accumulated economic cost over the prediction horizon of 




N


p




 sampling periods. At the next sampling time, Optimization problem 3 is solved again.
The resulting optimization problems are highly nonlinear with algebraic equations, thus the simultaneous approach to dynamic optimization is used in this work. This is because the simultaneous approach is more robust to problems with such properties compared to the sequential approach [
27
]. This approach has been presented in Biegler [
28
] and is summarized below:
The continuous time differential and algebraic model equations are discretized by approximating the state and control profiles by a family of polynomials on finite elements. This involves dividing the control horizon into a number of finite elements with the size of each element corresponding to one sampling time. Within each element, the state and input profiles are approximated by a family of polynomials. In this work, Radau orthogonal polynomials in Lagrange form is used.
The dynamic optimization problem is then formulated as a large scale nonlinear programming (NLP) problem.
The NLP problem is solved using a computationally efficient solver that exploits the sparsity in the resulting matrix.
The continuous time differential and algebraic model equations are discretized by approximating the state and control profiles by a family of polynomials on finite elements. This involves dividing the control horizon into a number of finite elements with the size of each element corresponding to one sampling time. Within each element, the state and input profiles are approximated by a family of polynomials. In this work, Radau orthogonal polynomials in Lagrange form is used.
The dynamic optimization problem is then formulated as a large scale nonlinear programming (NLP) problem.
The NLP problem is solved using a computationally efficient solver that exploits the sparsity in the resulting matrix.
The formulation of the optimization problem is presented below:
Optimization problem 4.
 Reformulated optimization problem.















min








x


˜






i


,


k






,






z


˜






i


,


k






,




u




i


,


k




















∑




i


=


0






N


−


1








l


e






(






x


˜




i




,






z


˜




i




,




u


i




,




p


i




)




,
















(49)


















s


.


t


.
















∑




j


=


1




K








ℓ


˙




j






(




τ


k




)








x


˜






i


,


j






−




h


i




f




(






x


˜






i


,


k






,






z


˜






i


,


k






,




u




i


,


k






,




p


i




)




=


0






i


=


1


,


…


,


N




k


=


1


,


…


,


K


,
















(50)


























g


(






x


˜






i


,


k






,






z


˜






i


,


k






,




u




i


,


k






,




p


i




)


=


0






i


=


1


,


…


,


N




k


=


1


,


…


,


K


,
















(51)
























x


˜






i


+


1


,


0






=




∑




j


=


0




K






ℓ


j






(


1


)








x


˜






i


,


j










i


=


1


,


…


,


N


−


1


,
















(52)




























u




i


,


k






=




u




i


,


0










i


=


1


,


…


,


N


−


1




k


=


1


,


…


,


K


,
















(53)






















u




i


,


k






∈


U






i


=


1


,


…


,


N


−


1




k


=


1


,


…


,


K


,
















(54)




























x




i


,


k






∈


X






i


=


1


,


…


,


N




k


=


1


,


…


,


K


,
















(55)





where











ℓ


j






(


τ


)




=




∏




k


=


1


,


k


≠


j




K








τ


−




τ


k










τ


j




−




τ


k








.










(58)




In Optimization problem 4 above, subscripts 
i
 and 
k
 represent the 
i
-th finite element in the prediction horizon and 
k
-th collocation point in each finite element, respectively. 






ℓ


j






(




τ


k




)






 represents the Lagrange interpolation profile in a finite element, 
h
 is the length of a finite element and 
K
 is the number of collocation points in an element. 


τ


 is a root in the interpolating polynomial. Equation (
49
) is the objective function to be minimized, Equation (
50
) is an implicit formulation of the approximated model, Equation (
51
) is the algebraic equations, Equation (
52
) is a constraint that ensures that the beginning of an element is equal to the end of the previous element i.e., continuity constraint, Equation (
54
) ensures that the inputs are constant within an element similar to a zero-order hold (ZOH) fashion, and Equations (
55
) and (
57
) are inputs and state constraints. The output equation and soft constraints can also be added to this formulation. However, it has been omitted for simplicity. It should be noted that, in this formulation, the current state of the plant is enforced using the state constraints at 




i


=


0




 as the current state or measurement from the plant is not required in the formulation.
The model as well as the optimization problems (steady-state, EMPC and MPC) were implemented in Python (version 2.7) and casADi (version 3.4.0)—a software framework to facilitate the implementation and solution to optimal control problems using automatic differentiation [
29
]. The dynamic optimization problems (MPC and EMPC) were formulated as Optimization problem 4 and solved using the nonlinear programming (NLP) solver, IPOPT [
30
].
In this section, the results of this study are presented. First, the determination of the tuning parameters of MPC is presented. Following this, the case of time-varying operation of the PCC plant is considered. Within this case, a suitable update strategy for MPC is determined and the performance of both controllers with and without carbon tax-free limit is investigated. Finally, the performance of the controllers under uncertainty in the flue gas flow rate and CO






2




 concentration are presented and briefly discussed.
The prediction and control horizons for both MPC and EMPC was set as 360 min with 10 min being the sampling time (
N
 in Optimization problem 4 is 36). The number of collocation points within each element (
K
 in Optimization problem 4 was fixed at 3). No terminal constraints or costs were used in this work at the expense of using a sufficiently long horizon. The PCC plant configuration and flue gas condition are shown in 
Table 1
.
As can be observed from 
Table 1
, the plant configuration used in this study is a pilot plant. The reason for this choice stems from the fact that several authors have used this configuration in the study of flexible operation and control of the PCC process [
9
,
20
]. Again, this configuration has been used to validate the absorber and desorber models on which this work is based on [
20
]. The scale of the plant is not expected to affect the outcomes of this work. This is because the primary goal of this work is to compare the ease of flexible operation and performance (economic and energy efficiency) improvements of EMPC over conventional MPC when applied to the PCC process. Thus, the study conducted is relative and not absolute. The results of this study can therefore be used irrespective of the size of the plant under study.
In a typical power plant, the operation is periodic everyday (24 h). The demand for electricity is usually low at dawn and rises to a peak in the middle of the day and then drops to a low at night. A consequence of changing electricity demand is that the flue gas flow rate fluctuates in a similar manner affecting the operation of the attached post combustion capture plant. Again, during the high peak periods, steam, which is required in the regeneration section, may be unavailable since it will be needed for electricity generation. It is therefore important to determine how a deployed controller in the PCC plant reacts to such changes. The selected MPC controller was compared to EMPC in terms of economic performance. To assess the performance of EMPC and MPC for this kind of operation, the 24-h operation was scaled to 5 h. 
Figure 3
 shows the shape of a periodic disturbance for both the steam price and the flue gas flow rate. The demand for electricity is low in the first hour which translates into a low flue gas flow rate. It then ramps up for half an hour and remains constant for 2 h before ramping down. In addition, as the demand for electricity increases, a decision has to be made whether to use the steam to generate more electricity or channel it to the PCC plant for CO






2




 regeneration. This decision is accounted for as an increase in the price of steam. The nominal value for the price of steam was taken from the study of He et al. [
9
].
To ensure fair comparison of the two controllers, the MPC need to be well tuned. Several MPC tuning techniques exist. However, in this work, the MPC was tuned such that the closed-loop trajectories and economic performance of MPC was as close as possible to that of EMPC. This was achieved using two step tests. The first step test corresponds to a state where the plant transitions from a peak electricity demand period (steam price is 1.8 and flue gas flow is 1.3) to a low electricity demand period (steam price is 1.0 and flue gas flow is 1.0). The second step test is the reverse of the first step test where the plant transitions from a low electricity demand period to a peak electricity demand period. Three MPCs with different tuning parameters (as shown in 
Table 2
) and EMPC were designed and tested on the step tests. The resulting closed-loop trajectories are shown in 
Figure 4
 and 
Figure 5
.
Based on 
Figure 4
 and 
Figure 5
, MPC II was chosen for further tests. The weighting matrices are shown below. These parameters imply weakly tracking the CO






2




 emission as compared to the reboiler temperature and putting less weights on the inputs. The weights on the inputs are to ensure that the MPC does not make excessive control actions as compared to that of the EMPC:








Q


=










a






0










0






b










,




R


=










c






0










0






d




















In this work, the set-point update strategy is based on the frequency at which the steady-state optimization (SSO) of is carried out. Thus, the optimal steady-state operating point or set-point is determined at regular time intervals taking into consideration all information affecting the plant. 
Table 3
 shows different MPC set-point update strategies, and their impact on the economic performance and heat duty compared to that of EMPC. For example, in strategy 1, the set-point is kept constant throughout the operation of the plant irrespective of the changes in flue gas flow rate and price of steam. In strategies 2–4, on the other hand, the SSO is computed and the set-point of MPC is updated at regular time intervals according to the update frequency. It can be observed in 
Table 3
 that not updating the set-point is the worst strategy economically. This is because, when the set-point is kept constant throughout the operation of the PCC plant, any fluctuation in the flue gas flow rate is rejected at the expense of high operating costs. This is shown in 
Figure 6
. This gets better as the frequency of the updates increase. Updating the set-point every sampling time (10 min) is the best option, however, it still leaves an economic and heat duty gap between MPC and EMPC. This could be because the SSO layer does not take into account future economic information resulting in some economic losses and ineffective use of steam for regeneration.
In this set of simulations, the two operating scenarios are considered. In the first scenario, a tax-free emission limit is imposed. Emission beyond this limit leads to economic penalties. In the second scenario, charges are applied to any CO






2




 emitted. These scenarios were implemented as soft constraints in Optimization problems 1 and 3. Considering the scale of the PCC plant used in this study, 




y




l


i


m


i


t






 in Equations (
26
) and (
45
) was fixed at a value of 10.00 




kg


/


h




 and 0.00 




kg


/


h




 for the first and second scenarios, respectively. The horizon (prediction and control) for both MPC and EMPC is fixed at 360 min with a sampling time of 10 min (this implies N = 36). An MPC-SSO structure is used with MPC set-point update frequency of 1 h. The weighting matrices of the MPC are the same as the ones presented in 
Section 4.1
. All information (flue gas flow rate and price of steam) is available to both controllers. In the case of MPC, the SSO uses the instantaneous information on the flue gas flow rate and the steam price to conduct steady-state economic optimization and updates the set-point of MPC every hour while in the case of EMPC, future information is used to determine the optimal input to the PCC plant at every sampling time. The MPC uses future information on the flue gas flow rate to determine the optimal input to the PCC plant to reach the target set-point every sampling time. The simulation time is 5 h with time-varying steam price and flue gas flow rate as presented in 
Figure 3
.
Four sets of simulations are conducted in this scenario. The settings remained the same in each of the simulations with the exception of the carbon tax, which varied from simulation to simulation. The carbon tax considered are 
$
50.00, 
$
100.00, 
$
150.00 and 
$
200.00 per tonne CO






2




. The goal is to determine the operating strategy, compare the economic performance and the influence of the carbon tax on the performance of the two controllers under scenario one.
Figure 7
 and 
Figure 8
 show the CO






2




 emission, input and economic cost trajectories for the PCC process for each controller under scenario one at carbon tax of 
$
50.00 and 
$
200.00, respectively. At a carbon tax of 
$
50.00 per tonne CO






2




 (
Figure 7
), both EMPC and MPC-SSO schemes either stayed on or above the emission limit. This is because there is no incentive for capturing more CO






2




 and operating below the emission limit. In addition, the effect of not considering the process economics every sampling time for MPC can be seen in the CO






2




 emission trajectories of the system. EMPC starts to quickly violate the emission limit as a result of the increase in flue gas flow rate and heat price while MPC sluggishly does that. The sluggishness could be because MPC tries to reject the ramp change in the flue gas flow rate until the set-point is updated by the SSO. Again, in the last hour when the flue gas flow rate and heat price decrease, EMPC rapidly decreases the emissions compared to that of MPC. Although MPC had information about the ramp increase and decrease in flue gas flow rate, it had no idea of the change in steam price, hence the sluggishness. This information became available to MPC only after the set-point of MPC was updated by the SSO. However, in the case of EMPC, both heat price and flue gas flow rate were considered. Again, in 
Figure 8
, both controllers tried to stay above the emission limit—however, with much less emissions compared to when the carbon tax is 
$
50.00 per tonne CO






2




. This is because there is much more weight now on emissions compared to the cost of steam. It can also be observed that the CO






2




 emission trajectories of both MPC and EMPC are different. MPC operates well below the emission limit and uses much more resources without any economic gains. Another reason is that, at a carbon tax of 
$
200.00, the control dynamics change from slow tracking of CO






2




 to fast tracking. However, MPC had already been tuned for a single case and needed re-tuning. This resulted in the increase in both the average economic cost and heat duty (
Figure 9
 and 
Figure 10
).
The average economic performances and heat duties of MPC and EMPC under scenario one and different carbon tax is shown in 
Figure 9
 and 
Figure 10
. As can be observed in 
Figure 9
, the economic performance gap between MPC and EMPC remained fairly constant as the carbon tax increases until 
$
150.00, where the gap widened. Similarly, the gap between the average heat duty remained the same until 
$
150.00 where it increases. One possible explanation for this is that, in this scenario, when the PCC plant operates on the emission limit, the carbon tax is not charged. Only the heat input is optimized. The dynamics of the economics therefore changes from heat input to CO






2




 emissions and back to heat input. This shifting dynamics could have resulted in the increased gap between MPC and EMPC when the CO






2




 price is high. In addition, one key observation is that the gap between MPC and EMPC is smaller for the economic cost compared to the heat duty plot. This implies that though the economics seem to be close, the heat input is not efficiently used in the case of MPC compared to EMPC. Thus, to ensure a better economic performance and heat duty of MPC, re-tuning or increased update frequency is probably necessary. However, determining the optimal tuning parameters of MPC is not always obvious and is a major challenge in MPC design. EMPC on the other hand is able to determine the optimal operating strategy without requiring an update in the controller settings and change in set-point update strategy. This makes EMPC well suited for flexible operation of the PCC process while being energy efficient.
The simulations conducted in this section and their purpose is similar to that of scenario one. The controller settings therefore remain the same. The only difference between the two scenarios is how the carbon tax is enforced. In this scenario, charges are applied to any CO






2




 released into the atmosphere. In 
Figure 11
 and 
Figure 12
, the CO






2




 emission trajectory for both controllers remain fairly the same in the first three hours and begin to differ slightly in the last two hours. However, this difference is not significant enough to cause much differences in the performance metrics (economic cost and heat duty) when the carbon tax increases. This can be observed in 
Figure 13
 and 
Figure 14
 where the gaps in the average economic cost and average heat duty are almost constant. Similar to the results in scenario one, the gap in the heat duty between MPC and EMPC is wider compared to their economic performance. Thus, under this scenario, changes in the carbon tax does not affect the performance of the controllers. This could be because, throughout the operation, the cost of CO






2




 emission dominates the decision making as compared to the case of scenario one where, when the PCC plant operates on the emission limit, CO






2




 emissions are not penalized. The difference in economic performance of both controllers can therefore be solely attributed to the timescale separation between MPC and SSO.
The presence of disturbances is a problem in many practical MPC applications. This could result in performance degradation or infeasibility. In this section, we subject the PCC process to disturbances in the flue gas flow rate and CO






2




 concentration. This is to test the susceptibility of the controllers to uncertainties. The uncertainties were obtained by adding Gaussian white noise to the flue gas flow rate and flue gas concentration, respectively. The simulation for each uncertainty was repeated many times, each time with a different random number seed value (varied from 1 to 10). Only one of plots for each uncertainty experiment has been presented. The controller design for both MPC and EMPC remain the same as the previous sections.
Figure 15
 and 
Figure 16
 show the trajectories of CO






2




 emission, economic cost and inputs for both controllers under uncertainty in flue gas flow rate and CO






2




 concentration, respectively. As can be observed in the figures, both controllers showed the satisfactory performance with very little performance degradation. Thus, under small uncertain disturbances, both controllers perform the same when there is uncertainty in the flue gas flow rate and concentration. One reason for this observation could be that the PCC plant is insensitive to small disturbances. However, due to numerical challenges encountered at high disturbances, further tests were not conducted. Uncertainty in the steam price was not considered because it is only considered in the cost function and does not affect the process dynamics. Thus, both controllers are expected to be affected in the same way.
Attaching an amine-based PCC plant to a power plant reduces the overall efficiency of the power plant especially in the wake of frequent changes in electricity demand and diversification of electricity generation sources. However, operating the PCC plant in a flexible manner can reduce the impact of attaching a PCC plant to a power plant. This study investigates the operation of a PCC process under time-varying disturbances in flue gas flow rate and steam price using EMPC. The economic cost and heat duty of the operation of the PCC process under EMPC was compared to that of tracking MPC. Two scenarios, namely with and without emission limits, were also investigated. This was achieved by first presenting a first principle model of the PCC process—followed by formulation and design of both controllers and the solution to the resulting optimization problems using the simultaneous approach for dynamic optimization.
The results show that operating the PCC plant at a constant set-point leads to significant economic losses and inefficient utilization of the steam from the power plant. Specifically, operating the PCC plant in a time-varying fashion using EMPC improves the operation of the process up to about 6% in terms of economic efficiency and 7% in terms of heat duty or energy efficiency. In addition, a nearly constant gap between the average economic cost and heat duty of the process operation at different carbon prices using EMPC and MPC was observed with the heat duty having a larger gap compared to the economic cost. However, under scenario one, the gap further increased at a CO






2




 price of 
$
200.00 per tonne, whereas the gap remained fairly the same under scenario two. Although this gap can be reduced by increasing the frequency of updating the set-point of MPC and/or re-tuning MPC altogether, obtaining the optimal tuning parameters of MPC is not always obvious. EMPC, on the other hand, was able to determine the appropriate control policy depending on the scenario without further tuning or updating. This makes it suitable for flexible operation of the PCC process while being energy efficient. Finally, it was observed in this study that both controllers are robust to small uncertain disturbances in the flue gas flow rate and concentration. The insight gained from this study is useful in an era where our energy demands need to be met while ensuring that emissions are at a minimum.
All authors contributed to the conceptualization of this work, simulation design and analysis of results. B.D.-N. and S.L. conducted the simulations and prepared the manuscript. J.L. supervised this research and reviewed the manuscript.
This research was funded by Natural Sciences and Engineering Research Council of Canada (NSERC) grant number RGPIN 435767.
The authors declare no conflict of interest.