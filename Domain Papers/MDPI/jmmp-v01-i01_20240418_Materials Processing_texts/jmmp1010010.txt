This paper presents a new numerical approach for modelling the 3D printing process of fibre reinforced polymer composites by fused deposition modelling (FDM). The approach is based on the coupling between two particle methods, namely smoothed particle hydrodynamics (SPH) and discrete element method (DEM). The coupled SPH-DEM model has distinctive advantages in dealing with the free surface flow, large deformation of fibres, and/or fibre-fibre interaction that are involved in the FDM process. A numerical feasibility study is carried out to demonstrate its capability for both short and continuous fibre reinforced polymer composites, with promising results achieved for the rheological flow and fibre orientation and deformation.
Fibre-reinforced polymer (FRP) composites are extensively used in lightweight constructions in the aerospace, automotive, infrastructure, energy, and sports sectors. Commercially used FRPs are mainly based on the use of thermosetting polymer matrices, but the increasing demand for rapid processes and improved impact performance has led to an increased interest in the use of thermoplastic polymer matrices [
1
]. Additionally, the pursuit of higher performance composites with more complex shapes and even lighter weight continues. The ever-new applications of FRPs pose a significant challenge to the traditional composites manufacturing technologies, which have limited control of the internal structures. Very often the traditional manufacturing of composites still requires machining/trimming/drilling and joining processes in order to meet the final geometric requirements, which further increases the risk of introducing random manufacturing defects/voids that are difficult to predict and could cause catastrophic failure.
In contrast, additive manufacturing (AM) builds a part layer by layer based on Computer-aided design (CAD) models. AM‚Äôs fast progress in recent times has enabled the material usage from initially single polymers to latterly polymer composites. This move towards the use of polymer composites for AM was driven by the fact that printed polymer (mainly thermoplastic) products show a lack of strength and are limited in functionality, whilst fully functional and load-bearing parts are required by industries. The incorporation of fibre reinforcement in the printing polymer leads to improved mechanical performance and additional functionality [
2
]. Existing AM technologies for FRP composites are mainly based on thermal extrusion methods, such as Fused Deposition Modelling (FDM) originally developed by Stratasys [
3
] and adopted in [
4
], and Direct Writing (DW) [
5
]. In FDM, short fibres and polymer pellets are mixed and fabricated into extruded filaments for printing. Whilst in DW processes, short fibres and polymer paste are mixed and extruded directly from the printer. The Mark One and Mark Two printers recently developed by Markforged are capable of printing continuous carbon fibres using FDM [
6
]. Other different AM technologies for FRP composites are Selective Lamination Composite Object Manufacturing (SLCOM), which cuts and bonds woven composite sheets [
7
], and Laser Powder Bed Fusion (LPBF), which uses laser to melt a fibre-filled polymer powder [
8
]. In this study, we will focus on the extrusion based FDM technology. It should be noted that together with control on the printing path, FDM 3D printing provides the flexibility to incorporate multi-functionality, such as ultrasound [
9
] and magnetic field [
10
], to print composites with desired architectures.
However, one of the main limitations of FDM printing for fibre reinforced polymer composites is that the printed composites have a lower mechanical performance as compared to traditionally manufactured composites, due to fibre misalignment and porosity (or voids) introduced during the manufacturing process [
2
]. Most of the current research is focused mostly on investigating the effects of process and material parameters on the mechanical performance of printed part in material science [
11
,
12
,
13
,
14
] and tissue engineering [
15
]. However, the inter-relationship between the materials, process, and product is still not fully studied and incorporated. Therefore, 3D printing of composites is still a trial and error process, which lacks systematic studies, i.e., a combination of analytic, computational, and experimental approaches. There is lack of an integrated modelling and optimisation tools for the design and implementation of 3D printing of composites. To maximize the advantages of 3D printing for composites, there is a need for the development of a computer tool to model and optimise the printing process. The FDM printing process of short fibre reinforced composites is a fluid-solid flow problem, where fibres are the solid and the melted plastic is the fluid. The FDM printing process of continuous fibre reinforced composites is a typical fluid-structure interaction (FSI) problem, where fibres deform and deposit in the melted plastic, which is extruded as a fluid. In our previous work we have developed particle models for both fluid-solid flow [
16
] and fluid-structure interaction [
17
], which allows the free surface flow of melted plastic, fibre-resin interaction, and fibre collision/failure. Thus, in this study we attempt to model the 3D printing process of composites. It should be noted that several particle methods have been proposed and adopted to model the 3D printing of single phase materials, such as polymer [
18
] and metal powder [
19
], but to the authors‚Äô best knowledge, the modelling of the 3D printing process of fiber reinforced composites has been rarely reported.
As a long term goal, we aim to establish an integrated, particle methods based approach to model and to optimise the whole process of the 3D printing of fibre-reinforced polymer composites, from the printing materials, through the printing processes, to printed composites. As a first step, in this study we adopt our newly developed particle methods based approach for modelling the flow of the composites and their interaction with the print head, print nozzle, and print bed during the 3D printing process. Next, we will extend the present model by considering more physical (e.g., transient heat transfer between polymer and fibres, as well as the heat transfer between printed beads and printing bead) and chemical (e.g., solidification and crystallization of polymer) phenomenon. Combined with the optimisation approach and together with experimental validations, such through-process computational tool can be used to improve the printable materials, optimise the printing processes, and evaluate the printed composites.
In the 3D printing process of fibre reinforced polymer composites, fibres and resins are a mixture contained in the chamber of printing head. Modelling the printing process of composites is much more complicated than single materials and the interaction between fibres and resin must be considered to understand the spatial distribution of fibres. To better model the 3D printing process, we proposed a particle method based approach that is based on the coupling of two particle methods, i.e., Smoothed Particle Hydrodynamics (SPH) and Discrete Element Method (DEM). In this coupled SPH-DEM model, fibres are represented by bonded DEM particles to allow for deformation and even fracture when it necessarily occurs, and resin as a Newtonian incompressible fluid is represented by discrete SPH particles governed by Naiver-Stokes equations. In addition, a physical model was introduced to compute the drag force acting on the fibre and its reaction force returned to surrounding resin. It should be noted that drag force is the only interaction force considered in the current 2D simulations of the 3D printing process of composites. Besides, a local average technique, which is a widely used method for simulating sedimentation [
20
], is employed in this study to deal with the immersed fibre-resin interaction.
With SPH, the resin in fluid phase is spatially represented by a set of discrete particles moving in accordance with the Navier-Stokes equations. The movement of each particle is determined by the overall interactions from nearby particles within a support domain as shown in 
Figure 1
.
.
In SPH, each particle, which carries its own mass and density, is affected by the surrounding particles within the support domain. The density of each particle can be approximated by using a method called continuity density, in which the approximation of density is processed through the continuity equations and some transformations [
21
]:














D




œÅ


i








D


t






=






‚àë






j


=


1




N






m


j






v




i


j










‚àÇ




W




i


j










‚àÇ




x


i


















(1)





where subscripts 






i






 and 






j






 represent particle 




i




 and particle 




j




, respectively, and particles 




j




 as the surrounding ones of particle 




i




 are within the support domain of particle 




i




. 








m


j








 is the mass of particle 




j




, 








v




i


j










 is the relative velocity in this particle pairs. 








W




i


j










 is the kernel function and its gradient determines the contribution of these relative velocities. In this study, Wendland kernel is adopted in all simulations.
In the same way as the particle approximation of density, the moment equation in SPH form can be described as:














d




v




r


,


i










d


t






=






‚àë






j


=


1




n






m




r


,


j








(










P




r


,


i












œÅ




r


,


i




2








+








P




r


,


j












œÅ




r


,


j




2








+




ùõ±




r


,


i


j






+




R




r


,


i


j








)




ùõª




W




r


,


i


j






+




F




e


x


t






/




m




r


,


i
















(2)





where subscript 




r




 in this study is used to define the resin particles, 




P




 is the particle pressure, 








Œ†




i


j










 is the viscosity term, 








R




i


j










 is the anti-clump term for tensile instability and 








F




e


x


t










 is the external forces acting on particle 




i




.
As heat transfer is not considered in the current isothermal SPH-DEM model, the energy equation is not computed. The external forces, 








F




e


x


t










, are mainly subject to the reaction forces from the solid phase. Due to the nature of 2D simulations in this study, the reaction forces from the gravitational force and buoyancy force are not taken into consideration. Consequently, the drag force is the only force hydrodynamically acting on DEM particles (solid phase: fibres), and then its reaction is returned to the SPH particles (fluid phase: resin) accordingly.
The motion of each DEM particle is governed by various forces (e.g., drag force, bond force and direct contact force), which can be taken into consideration as follow:












m


f








d




v


f








d


t






=




‚àë






F


f


c




+




‚àë






F


f


b




+




F


f


d














(3)





where subscript 




f




 in this study is used to denote the fibre, 








v


f








 is the DEM particle velocity , 








F


f


c








 is the sum of direct contact force between different DEM particles, 








F


f


b








 is the sum of force transferred among bonds, and 








F


f


d








 is the drag force acting on a DEM particle from surrounding SPH particles.
The direct contact force and bond force in Equation (3) are modelled as a spring-dashpot system in normal and shear directions. The magnitude of the normal force is the product of the normal stiffness at the contact and the overlap between the two particles and the shear force is calculated in an incremental fashion. Initially the total shear force is set to zero upon the formation of contact and then in each timestep the relative incremental shear-displacement is added to the previous value in last timestep [
22
].
The drag force acting on DEM particles refers to the resistant effect of the surrounding SPH particles. It mainly depends on both the relative resin flow velocity and the local density of neighbouring DEM particles. For a single DEM particle, the drag force can be formulated as follows [
23
]:












F


f


d




=








Œ≤


f








1


‚àí




œµ


f










(










v


r






¬Ø




‚àí




v


f






)






V


f














(4)





where 








Œ≤


f








 is the interphase momentum transfer coefficient, 












v


r






¬Ø








 is the average resin flow velocity around DEM particle 




f




 for fibre. In accordance with the threshold value of 








œµ


f








, the value of 








Œ≤


f








 is divided into two regimes by combining the equations of Ergun [
24
] and Wen and Yu [
25
]:












Œ≤


f




=




{












150












(




1


‚àí




œµ


f






)






2










œµ


f














Œº


r










d


f


2








+


1


.


75




(




1


‚àí




œµ


f






)










œÅ


r










d


r










|










v


r






¬Ø




‚àí




v


f






|




¬†




œµ


f




‚â§


0


.


8














7


.


5




C


d










œµ


f






(




1


‚àí




œµ


f






)










d


f










œÅ


r






|










v


r






¬Ø




‚àí




v


f






|






œµ


f




‚àí


2


.


65






¬†




œµ


f




>


0


.


8
























(5)





where 








Œº


f








 is the viscosity of resin, 








œÅ


f








 is the reference density of resin, 








C


d








 is the drag coefficient of a single DEM particle and 








d


f








 is the diameter of DEM particle. The velocity of the surrounding resin flow is approximated by using Shepard filter:












|








v


¬Ø




r






|




=








‚àë






v


r






V


r




W








‚àë






V


r




W
















(6)





where 








v


r








 is the velocity of the SPH particle. The drag coefficient 








C


d








 is relevant to Reynolds number and given by:












C


d




=




{
















24






R




e


f










(




1


+


0


.


15


R




e


f




0


.


687








)




¬†


R




e


f




‚â§


1000














0


.


44


¬†


R




e


f




>


1000
























(7)




The aforementioned drag force acts on the DEM particles, then the equal and opposite forces should be acted upon the SPH particles. Employing the kernel function, these reactions on each SPH particle by the drag force acting on a DEM particle is determined by a partition of the drag force in proportion to the weight of each SPH particle:












F




e


x


t






=


‚àí








m


r










œÅ


r










‚àë






1






S




f


1












F


f


d






W




f


r
















(8)
















S




f


1






=




‚àë










m




f


2












œÅ




f


2












W




f


1


f


2
















(9)




Replacing the external force term 








F




e


x


t










 in the momentum equation for fluid phase, we find that Equation (2) becomes:














d




v




r


,


i










d


t






=






‚àë






j


=


1




n






m




r


,


j








(










P




r


,


i












œÅ




r


,


i




2








+








P




r


,


j












œÅ




r


,


j




2








+




Œ†




r


,


i


j






+




R




r


,


i


j








)




ùõª




W




r


,


i


j






‚àí




(










m


r










œÅ


r










‚àë






1






S




f


1












F


f


d






W




f


r








)




/




m




r


,


i
















(10)




The acceleration of SPH and DEM particles obtained from Equations (2) and (3) will be used to calculate the velocity and displacement using a central difference method. The position of the each particle is updated according to the new displacement and a new computation circle starts with the searching of neighbour particles. Details of SPH and DEM approaches and their coupling as well as validations are referred to [
17
].
Two cases of 3D printing of composites are investigated using the coupled SPH-DEM model to demonstrate its capability and potential for simulating the printing process of short and continuous fibre reinforced polymer composites. The geometry of the print head and the printing process parameters are shown in 
Figure 2
. The configurations for the two cases are slightly different that the height of print head chamber where initially holds resin and fibres in the case of short glass fibre is 3 mm, but 5 mm in the case of continuous carbon fibre to ensure a reasonable length of fibre are printed out, as shown in 
Figure 2
. The widths of the print head and shower nozzle are 3 mm and 0.6 mm, respectively. All of the dimensions are the same except for the length of the print head chamber in both cases. The short glass fiber and continuous carbon are soaked in the resin in both cases. The short glass fibers are created randomly and distributed parallel to the moving wall, while the continuous carbon fiber is located at the center of the print head, perpendicular to the moving wall. In the both cases, the moving wall, print head, fixed print bed, and resins are made of the SPH elements while the fibers are made of DEM elements. Specifically, the material of resin in the first case is ABS while Nylon for the second case. In the second case, the continuous carbon fiber is three layers wide of the DEM particles and as long as the printing head chamber. There are very limited data published for the extrusion nozzle and various feed rates and translational printing speeds are used in other research, therefore, in this study we adopt a print nozzle similar to, but ten times smaller than, those used in short fibre injection moulding [
26
]. The feed rate of 
V
1
 = 30 mm/s and printing speed of 
V
2
 = 40 mm/s in a similar range as those used in [
12
,
27
]. In the current study, the 3D printing is assumed to be processed in a constant high temperature without any solidification. As a result, there is no energy transformation and the movement of fibre is only due to the resin flow.
The first case is concerned with the FDM printing of short glass fibre reinforced acrylonitrile‚Äìbutadiene‚Äìstyrene (ABS) composites. Each short glass fibre is represented by four DEM particles, which are bonded together using a linear parallel bond model as shown in 
Figure 3
a. The collision between fibres is accounted using a linear contact model which is composed of a spring and a dashpot in both normal and tangential directions, as well as a frictional element, as shown in 
Figure 3
b. The density of ABS is 1050 km/m
3
 and its dynamic viscosity is 0.1 Pa‚àôs. The density of short glass fibre is 2540 kg/m
3
, each has a dimension of 100 √ó 25 ¬µm, and the total fibre volume fraction is 8.3% (equivalent to a weight content of 18%). The ultimate tensile strength of fibres is set as 2000 MPa.
The first case is concerned with the FDM printing of continuous carbon fibre reinforced Nylon composites. When printing the continuous carbon fibre reinforced thermoplastic composites in FDM, usually a fabricated filament is first melted and then extruded through the printer head. The specific carbon filament for Mark Two (Markforge) consists of 1000 carbon fibres (T300, with a density of 1600 kg/m
3
) and the matrix is most likely Nylon 6 (with a density of 1150 kg/m
3
 and dynamic viscosity of 0.1 Pa‚àôs) [
13
]. In our current 2D simulations, it is not reasonable to model the individual fibres as they are randomly distributed in the filament, instead a nominal fibre is created to occupy the same volumetric space in the printing head, i.e., 34.5% [
13
]. In this study, three layers of particles are vertically bonded together to form the nominal fibre bundle and the parallel bond stiffness is defined as follow:














k


¬Ø




n




=




E






R


a




+




R


b


















(11)


















k


¬Ø




s




=










k


¬Ø




n






k














(12)





where 
E
 is the Young‚Äôs modulus, 
R
a
 and 
R
b
 are radius of particles 
a
 and 
b
, respectively, 
k
 is the normal-to-shear stiffness ratio. In Equations (11) and (12), the Young‚Äôs modulus E is 75 GPa and the stiffness ratio k is set up to 0.25. As each individual particle size in the continuous fibre is identical all the time, 
R
a
 and 
R
b
 are equal to 0.025 mm.
In 
Figure 4
, the predicted transient flow patterns at different time intervals are shown for both cases. For short glass fibre/ABS at time 
t
 = 0.05 s, it can be seen that the orientation of fibres becomes more random as they are driven by the resin flow. In the regions where the fibres are close to the boundary walls, a velocity gradient of resin flow is noticeable due to the effect of the wall, therefore the orientation of fibres in these regions changes significantly, and eventually the fibres tend to move in parallel with boundary walls with a lower velocity. On the contrary, the orientation of fibres in the middle of the printing head changes slightly, despite the direct contact between fibres and becomes aligned with the velocity profile of resin flow. At time 
t
 = 0.1 s resins and short glass fibres move out from printing head and they are in contact with the printing bed. However, the orientation of some fibres is less aligned with the resin flow direction, which is due to the direct contact with boundary wall (printing bed) or other fibres. In addition, the flow split occurs outside of the printing head results in a much more complex velocity contour of resin flow, which may have an effect over the orientation of fibres.
For continuous carbon fibre/Nylon at time 
t
 = 0.05 s, the fibres firmly stay in the middle of the printing head due to geometric symmetry, at least no significant vibration and deformation observed, indicating the instability effect of moving the printing head gradually reduced from the commencement of process. At time 
t
 = 0.1 s, the fibres show a large bending deformation and there is a continuously direct contact between fibre and left edge of the printing head, which indicates the potential wear of the printing head.
Furthermore, there are two common observations in both cases. Firstly, when resin moves out from the printing head, there are always two split streams in the fixed bed in two opposite directions. It is mainly caused by the squeezing pressure within the print nozzle. The maximum velocity of resin flow is found in the print nozzle, where the resin starts to split and drives the fibres to move closer to the inner wall of the nozzle, which indicates the potential abrasive wear as reported in experiments [
28
]. In the meantime, as the moving velocity of printing head is constant all of the time, consequently, the velocity of resin just outside of the print nozzle will move faster than it, but confined by the fixed printing bed due to wall effect. Secondly, the velocity profile of resin in the print head is not evenly distributed, and it is evident that the velocity of resin on the right hand side of print head is relatively lower than that it is on the left hand side. As the print head moves from left to right, the left wall of the print head passively gives a force to drive the resin, but the force is firstly transferred to the resin close to the left wall of print head, therefore, there is a delay in force transition to the resin close to the right wall of print head. In 
Figure 5
, which shows the distribution of resin density, the density of the printed resin is lower than that under the squeezed process in the print head and print nozzle. This is due to the assumption in SPH that the incompressible flow has a compressibility feature in order to reflect the pressure distribution indirectly. In 
Figure 6
, the deformation of continuous fibres is not visibly noticeable, and the stress is evenly distributed and not in a high order of magnitude at time 
t
 = 0.05 s. This is due to the fact that the fully immersed continuous fibres are still within the print head at 
t
 = 0.05 s, and the velocity contour in either side of the continuous fibre is almost identical, the interaction forces acting on continuous fibre are ignorable, and as a result, no significant deformation is observed. At time 
t
 = 0.1 s, the tensile stress is significant due to the bending. The fibres are in contact with the lower end of left hand side of print nozzle, which could cause severe abrasive wear.
This study presents the potential applications of a coupled SPH-DEM model to simulate the 3D printing process of short or continuous fibre reinforced polymer composites by fused deposition modelling (FDM). Fibres are represented by discrete DEM particles bonded together to capture the deformation and even fracture when it necessarily occurs, therefore, this model can track the motion and deformation of fibres and analyse their interaction with resin during the 3D printing process. Resin as a fluid phase is represented by discrete SPH particles. Fibre orientation and deformation are predicted to shed a light on the 3D printing of short or continuous fibre reinforced polymer composites (e.g., void formation, fibre distribution, etc.). For future work, the current model will be extended to three dimensions and further improvement will be made by considering heat transfer, consolidation, and crystallisation, together with comprehensive validations against experiments.
Dongmin Yang conceived and designed the experiments; Ke Wu performed the experiments; Dongmin Yang, Ke Wu, Lei Wan and Yong Sheng analyzed the data; Yong Sheng contributed analysis tools; Dongmin Yang, Ke Wu, Lei Wan and Yong Sheng wrote the paper.
The authors declare no conflicts of interest.